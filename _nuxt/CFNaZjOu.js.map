{"version":3,"file":"CFNaZjOu.js","sources":["../../../node_modules/viem/_esm/actions/public/getBalance.js","../../../node_modules/@wagmi/core/dist/esm/actions/estimateGas.js","../../../node_modules/@wagmi/core/dist/esm/actions/getBalance.js","../../../node_modules/@wagmi/core/dist/esm/actions/getGasPrice.js","../../../node_modules/@wagmi/core/dist/esm/actions/waitForTransactionReceipt.js","../../../node_modules/@wagmi/core/dist/esm/actions/writeContract.js","../../../node_modules/@wagmi/core/dist/esm/query/writeContract.js","../../../node_modules/@wagmi/vue/dist/esm/composables/useWriteContract.js","../../../composables/useNFTContractWriter.ts","../../../composables/useNFTMinter.ts"],"sourcesContent":["import { numberToHex, } from '../../utils/encoding/toHex.js';\n/**\n * Returns the balance of an address in wei.\n *\n * - Docs: https://viem.sh/docs/actions/public/getBalance\n * - JSON-RPC Methods: [`eth_getBalance`](https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_getbalance)\n *\n * You can convert the balance to ether units with [`formatEther`](https://viem.sh/docs/utilities/formatEther).\n *\n * ```ts\n * const balance = await getBalance(client, {\n *   address: '0xA0Cf798816D4b9b9866b5330EEa46a18382f251e',\n *   blockTag: 'safe'\n * })\n * const balanceAsEther = formatEther(balance)\n * // \"6.942\"\n * ```\n *\n * @param client - Client to use\n * @param parameters - {@link GetBalanceParameters}\n * @returns The balance of the address in wei. {@link GetBalanceReturnType}\n *\n * @example\n * import { createPublicClient, http } from 'viem'\n * import { mainnet } from 'viem/chains'\n * import { getBalance } from 'viem/public'\n *\n * const client = createPublicClient({\n *   chain: mainnet,\n *   transport: http(),\n * })\n * const balance = await getBalance(client, {\n *   address: '0xA0Cf798816D4b9b9866b5330EEa46a18382f251e',\n * })\n * // 10000000000000000000000n (wei)\n */\nexport async function getBalance(client, { address, blockNumber, blockTag = client.experimental_blockTag ?? 'latest', }) {\n    const blockNumberHex = typeof blockNumber === 'bigint' ? numberToHex(blockNumber) : undefined;\n    const balance = await client.request({\n        method: 'eth_getBalance',\n        params: [address, blockNumberHex || blockTag],\n    });\n    return BigInt(balance);\n}\n//# sourceMappingURL=getBalance.js.map","import { estimateGas as viem_estimateGas, } from 'viem/actions';\nimport { getAction } from '../utils/getAction.js';\nimport { getConnectorClient, } from './getConnectorClient.js';\n/** https://wagmi.sh/core/api/actions/estimateGas */\nexport async function estimateGas(config, parameters) {\n    const { chainId, connector, ...rest } = parameters;\n    let account;\n    if (parameters.account)\n        account = parameters.account;\n    else {\n        const connectorClient = await getConnectorClient(config, {\n            account: parameters.account,\n            assertChainId: false,\n            chainId,\n            connector,\n        });\n        account = connectorClient.account;\n    }\n    const client = config.getClient({ chainId });\n    const action = getAction(client, viem_estimateGas, 'estimateGas');\n    return action({ ...rest, account });\n}\n//# sourceMappingURL=estimateGas.js.map","import { getBalance as viem_getBalance, } from 'viem/actions';\nimport { getAction } from '../utils/getAction.js';\n/** https://wagmi.sh/core/api/actions/getBalance */\nexport async function getBalance(config, parameters) {\n    const { address, blockNumber, blockTag, chainId } = parameters;\n    const client = config.getClient({ chainId });\n    const action = getAction(client, viem_getBalance, 'getBalance');\n    const value = await action(blockNumber ? { address, blockNumber } : { address, blockTag });\n    const chain = config.chains.find((x) => x.id === chainId) ?? client.chain;\n    return {\n        decimals: chain.nativeCurrency.decimals,\n        symbol: chain.nativeCurrency.symbol,\n        value,\n    };\n}\n//# sourceMappingURL=getBalance.js.map","import { getGasPrice as viem_getGasPrice, } from 'viem/actions';\nimport { getAction } from '../utils/getAction.js';\n/** https://wagmi.sh/core/api/actions/getGasPrice */\nexport function getGasPrice(config, parameters = {}) {\n    const { chainId } = parameters;\n    const client = config.getClient({ chainId });\n    const action = getAction(client, viem_getGasPrice, 'getGasPrice');\n    return action({});\n}\n//# sourceMappingURL=getGasPrice.js.map","import { hexToString } from 'viem';\nimport { call, getTransaction, waitForTransactionReceipt as viem_waitForTransactionReceipt, } from 'viem/actions';\nimport { getAction } from '../utils/getAction.js';\nexport async function waitForTransactionReceipt(config, parameters) {\n    const { chainId, timeout = 0, ...rest } = parameters;\n    const client = config.getClient({ chainId });\n    const action = getAction(client, viem_waitForTransactionReceipt, 'waitForTransactionReceipt');\n    const receipt = await action({ ...rest, timeout });\n    if (receipt.status === 'reverted') {\n        const action_getTransaction = getAction(client, getTransaction, 'getTransaction');\n        const { from: account, ...txn } = await action_getTransaction({\n            hash: receipt.transactionHash,\n        });\n        const action_call = getAction(client, call, 'call');\n        const code = await action_call({\n            ...txn,\n            account,\n            data: txn.input,\n            gasPrice: txn.type !== 'eip1559' ? txn.gasPrice : undefined,\n            maxFeePerGas: txn.type === 'eip1559' ? txn.maxFeePerGas : undefined,\n            maxPriorityFeePerGas: txn.type === 'eip1559' ? txn.maxPriorityFeePerGas : undefined,\n        });\n        const reason = code?.data\n            ? hexToString(`0x${code.data.substring(138)}`)\n            : 'unknown reason';\n        throw new Error(reason);\n    }\n    return {\n        ...receipt,\n        chainId: client.chain.id,\n    };\n}\n//# sourceMappingURL=waitForTransactionReceipt.js.map","import { writeContract as viem_writeContract, } from 'viem/actions';\nimport { getAction } from '../utils/getAction.js';\nimport { getConnectorClient, } from './getConnectorClient.js';\n/** https://wagmi.sh/core/api/actions/writeContract */\nexport async function writeContract(config, parameters) {\n    const { account, chainId, connector, ...request } = parameters;\n    let client;\n    if (typeof account === 'object' && account?.type === 'local')\n        client = config.getClient({ chainId });\n    else\n        client = await getConnectorClient(config, {\n            account: account ?? undefined,\n            assertChainId: false,\n            chainId,\n            connector,\n        });\n    const action = getAction(client, viem_writeContract, 'writeContract');\n    const hash = await action({\n        ...request,\n        ...(account ? { account } : {}),\n        chain: chainId ? { id: chainId } : null,\n    });\n    return hash;\n}\n//# sourceMappingURL=writeContract.js.map","import { writeContract, } from '../actions/writeContract.js';\nexport function writeContractMutationOptions(config) {\n    return {\n        mutationFn(variables) {\n            return writeContract(config, variables);\n        },\n        mutationKey: ['writeContract'],\n    };\n}\n//# sourceMappingURL=writeContract.js.map","import { useMutation } from '@tanstack/vue-query';\nimport { writeContractMutationOptions, } from '@wagmi/core/query';\nimport { useConfig } from './useConfig.js';\n/** https://wagmi.sh/vue/api/composables/useWriteContract */\nexport function useWriteContract(parameters = {}) {\n    const { mutation } = parameters;\n    const config = useConfig(parameters);\n    const mutationOptions = writeContractMutationOptions(config);\n    const { mutate, mutateAsync, ...result } = useMutation({\n        ...mutation,\n        ...mutationOptions,\n    });\n    return {\n        ...result,\n        writeContract: mutate,\n        writeContractAsync: mutateAsync,\n    };\n}\n//# sourceMappingURL=useWriteContract.js.map","import { useWriteContract } from '@wagmi/vue'\nimport { readContract, getBalance, waitForTransactionReceipt as wagmiWaitForTransactionReceipt, estimateGas, getGasPrice } from '@wagmi/vue/actions'\nimport { encodeFunctionData, formatEther } from 'viem'\nimport type { Abi, EstimateGasParameters } from 'viem'\nimport { LIKE_NFT_CLASS_ABI } from '~/contracts/likeNFT'\nimport { sleep } from '~/utils'\n\nexport const useNFTContractWriter = () => {\n  const { writeContractAsync } = useWriteContract()\n  const { $wagmiConfig: config } = useNuxtApp()\n  const { t: $t } = useI18n()\n  const toast = useToast()\n\n  const showGasFeeError = (walletAddress: string, currentBalance: bigint, neededBalance: bigint) => {\n    const currentBalanceFormatted = formatEther(currentBalance)\n    const neededBalanceFormatted = formatEther(neededBalance)\n    toast.add({\n      icon: 'i-heroicons-exclamation-circle',\n      title: $t('errors.insufficient_gas_fee'),\n      description: $t('errors.insufficient_gas_fee_description', {\n        currentBalance: currentBalanceFormatted,\n        neededBalance: neededBalanceFormatted\n      }),\n      duration: 0,\n      color: 'warning',\n      actions: [\n        {\n          label: $t('errors.contact_support'),\n          onClick: () => {\n            if (window.Intercom) {\n              window.Intercom('showNewMessage', $t('errors.insufficient_gas_fee_support_message', {\n                walletAddress,\n                currentBalance: currentBalanceFormatted,\n                neededBalance: neededBalanceFormatted\n              }))\n            }\n          }\n        }\n      ]\n    })\n  }\n\n  const checkAndGrantRole = async (\n    { classId, wallet }: { classId: string; wallet: string },\n    role: string\n  ) => {\n    const roleData = await readContract(config, {\n      abi: LIKE_NFT_CLASS_ABI,\n      address: classId as `0x${string}`,\n      functionName: role\n    })\n    const hasRole = await readContract(config, {\n      abi: LIKE_NFT_CLASS_ABI,\n      address: classId as `0x${string}`,\n      functionName: 'hasRole',\n      args: [roleData, wallet]\n    })\n    if (!hasRole) {\n      await assertSufficientBalanceForTransaction({\n        wallet,\n        address: classId as `0x${string}`,\n        abi: LIKE_NFT_CLASS_ABI,\n        functionName: 'ownerGrantRole',\n        args: [roleData, wallet]\n      })\n      const txHash = await writeContractAsync({\n        abi: LIKE_NFT_CLASS_ABI,\n        address: classId as `0x${string}`,\n        functionName: 'ownerGrantRole',\n        args: [roleData, wallet]\n      })\n      await waitForTransactionReceipt({ hash: txHash, confirmations: 2 })\n      // eslint-disable-next-line no-console\n      console.log(`Granted ${role} to ${wallet} in class ${classId}. Transaction hash: ${txHash}`)\n    }\n  }\n  const checkAndGrantUpdater = ({ classId, wallet }: { classId: string, wallet: string }) => {\n    return checkAndGrantRole({ classId, wallet }, 'UPDATER_ROLE')\n  }\n  const checkAndGrantMinter = ({ classId, wallet }: { classId: string, wallet: string }) => {\n    return checkAndGrantRole({ classId, wallet }, 'MINTER_ROLE')\n  }\n  const assertPositiveWalletBalance = async ({ wallet }: { wallet: string }) => {\n    const balance = await getBalance(config, {\n      address: wallet as `0x${string}`\n    })\n    if (balance.value <= 0n) {\n      throw new Error('WALLET_HAS_NO_BASE_ETH_BALANCE')\n    }\n    return balance\n  }\n\n  const assertSufficientBalanceForTransaction = async (params: {\n    wallet: string\n    address: `0x${string}`\n    abi: Abi\n    functionName: string\n    args?: unknown[]\n    value?: bigint\n  }) => {\n    const data = encodeFunctionData({\n      abi: params.abi,\n      functionName: params.functionName,\n      args: params.args\n    })\n    await assertSufficientBalanceForTx({\n      wallet: params.wallet,\n      tx: { to: params.address, data, value: params.value },\n      value: params.value\n    })\n  }\n\n  const waitForTransactionReceipt = async (\n    parameters: Parameters<typeof wagmiWaitForTransactionReceipt>[1]\n  ) => {\n    let receipt\n    try {\n      receipt = await wagmiWaitForTransactionReceipt(config, parameters)\n    } catch (error) {\n      // Sometimes a TransactionReceiptNotFoundError would be thrown\n      // https://github.com/wevm/viem/issues/1056\n      await sleep(3000)\n      receipt = await wagmiWaitForTransactionReceipt(config, parameters)\n    }\n    return receipt\n  }\n\n  const assertSufficientBalanceForTransfer = async (params: {\n    wallet: string\n    to: `0x${string}`\n    value: bigint\n    data?: `0x${string}`\n  }) => {\n    await assertSufficientBalanceForTx({\n      wallet: params.wallet,\n      tx: { to: params.to, value: params.value, data: params.data },\n      value: params.value\n    })\n  }\n\n  const assertSufficientBalanceForTx = async (params: {\n    wallet: string\n    tx: EstimateGasParameters\n    value?: bigint\n  }) => {\n    const { wallet, tx, value } = params\n    const hasTo = 'to' in tx\n    const hasData = 'data' in tx && (tx as { data?: `0x${string}` | undefined }).data != null\n    const defaultGasLimit = hasData ? 1_500_000n : hasTo ? 21000n : 500000n\n\n    const [balanceResult, gasEstimateResult, gasPriceResult] = await Promise.allSettled([\n      getBalance(config, { address: wallet as `0x${string}` }),\n      estimateGas(config, { ...tx, account: wallet as `0x${string}` }),\n      getGasPrice(config)\n    ])\n\n    const balance = balanceResult.status === 'fulfilled' ? balanceResult.value : { value: 0n }\n    const gasEstimate = gasEstimateResult.status === 'fulfilled' ? gasEstimateResult.value : defaultGasLimit\n    const estimatedGasPrice = gasPriceResult.status === 'fulfilled' ? gasPriceResult.value : 1000000000n // 1 gwei fallback for Base\n\n    const estimatedGasCost = gasEstimate * estimatedGasPrice\n    // Add a 20% safety buffer to the estimated gas cost to account for gas price volatility\n    // and potential differences between estimation time and actual transaction execution.\n    const requiredBalance = (estimatedGasCost * 120n) / 100n\n    const totalRequired = requiredBalance + (value ?? 0n)\n\n    if (balance.value < totalRequired) {\n      showGasFeeError(wallet, balance.value, totalRequired)\n      throw new Error('INSUFFICIENT_GAS_FEE_BALANCE')\n    }\n\n    return { balance, gasEstimate, estimatedGasCost, requiredBalance }\n  }\n\n  return {\n    checkAndGrantUpdater,\n    checkAndGrantMinter,\n    assertPositiveWalletBalance,\n    assertSufficientBalanceForTransaction,\n    assertSufficientBalanceForTransfer,\n    waitForTransactionReceipt\n  }\n}\n","import { useWriteContract } from '@wagmi/vue'\nimport { LIKE_NFT_CLASS_ABI } from '~/contracts/likeNFT'\n\nexport interface NFTTokenMetadata {\n  image: string\n  external_url: string\n  description: string\n  name: string\n  attributes?: Array<{ trait_type: string; value: string | number; display_type?: string }>\n}\n\nexport function useNFTMinter () {\n  const walletStore = useWalletStore()\n  const { wallet } = storeToRefs(walletStore)\n  const { checkAndGrantMinter, assertSufficientBalanceForTransaction, waitForTransactionReceipt } = useNFTContractWriter()\n  const { getClassCurrentTokenId } = useNFTContractReader()\n  const { writeContractAsync } = useWriteContract()\n\n  async function mintNFT (params: {\n    classId: string\n    mintCount: number\n    buildTokenMetadata: (index: number, fromTokenId: bigint) => NFTTokenMetadata\n  }): Promise<{ txHash: string; fromTokenId: bigint }> {\n    const { classId, mintCount, buildTokenMetadata } = params\n\n    await checkAndGrantMinter({\n      classId,\n      wallet: wallet.value!\n    })\n\n    const fromTokenId = await getClassCurrentTokenId(classId) as bigint\n\n    const nfts = [...Array(mintCount).keys()].map(i =>\n      buildTokenMetadata(i, fromTokenId)\n    )\n\n    const txParams = {\n      address: classId as `0x${string}`,\n      abi: LIKE_NFT_CLASS_ABI,\n      functionName: 'safeMintWithTokenId' as const,\n      args: [\n        fromTokenId,\n        Array(mintCount).fill(wallet.value),\n        Array(mintCount).fill(''),\n        nfts.map(nft => JSON.stringify(nft))\n      ]\n    }\n\n    await assertSufficientBalanceForTransaction({\n      wallet: wallet.value!,\n      ...txParams\n    })\n\n    const txHash = await writeContractAsync(txParams)\n    const receipt = await waitForTransactionReceipt({ hash: txHash, confirmations: 2 })\n\n    if (!receipt || receipt.status !== 'success') {\n      throw new Error('NFT minting failed')\n    }\n\n    return { txHash, fromTokenId }\n  }\n\n  return { mintNFT }\n}\n"],"names":["getBalance","client","address","blockNumber","blockTag","blockNumberHex","numberToHex","balance","estimateGas","config","parameters","chainId","connector","rest","account","getConnectorClient","getAction","viem_estimateGas","value","viem_getBalance","chain","x","getGasPrice","viem_getGasPrice","waitForTransactionReceipt","timeout","receipt","viem_waitForTransactionReceipt","action_getTransaction","getTransaction","txn","code","call","reason","hexToString","writeContract","request","viem_writeContract","writeContractMutationOptions","variables","useWriteContract","mutation","useConfig","mutationOptions","mutate","mutateAsync","result","useMutation","useNFTContractWriter","writeContractAsync","useNuxtApp","$t","useI18n","toast","useToast","showGasFeeError","walletAddress","currentBalance","neededBalance","currentBalanceFormatted","formatEther","neededBalanceFormatted","checkAndGrantRole","classId","wallet","role","roleData","readContract","LIKE_NFT_CLASS_ABI","assertSufficientBalanceForTransaction","txHash","checkAndGrantUpdater","checkAndGrantMinter","assertPositiveWalletBalance","params","data","encodeFunctionData","assertSufficientBalanceForTx","wagmiWaitForTransactionReceipt","sleep","assertSufficientBalanceForTransfer","tx","hasTo","defaultGasLimit","balanceResult","gasEstimateResult","gasPriceResult","gasEstimate","estimatedGasPrice","estimatedGasCost","requiredBalance","totalRequired","useNFTMinter","walletStore","useWalletStore","storeToRefs","getClassCurrentTokenId","useNFTContractReader","mintNFT","mintCount","buildTokenMetadata","fromTokenId","nfts","i","txParams","nft"],"mappings":"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"}