import{g as P,Q as V,a as j,b as z,s as q,B as J,e as _,w as W,o as Y,l as S,m as $,n,L as b,W as Q,p as l,M as u,q as a,ao as F,N as C,Y as G,c as D,a1 as H,ac as X,$ as Z,aj as k,ak as x,al as L,am as N}from"./9S2XGRg9.js";import{_ as ee}from"./drKZnbC8.js";import{_ as ae}from"./CLuOJMie.js";(function(){try{var d=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};d.SENTRY_RELEASE={id:"cd189bad150b481aa5ecb2e95de26ec677010e55"}}catch{}})();try{(function(){var d=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new d.Error().stack;e&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[e]="91d7ea2a-2898-4c76-bd01-154958ea220c",d._sentryDebugIdIdentifier="sentry-dbid-91d7ea2a-2898-4c76-bd01-154958ea220c")})()}catch{}const te={class:"flex justify-between gap-4"},se={class:"text-lg font-bold font-mono flex-wrap"},oe={class:"font-bold font-mono"},ne={class:"text-sm font-bold font-mono"},ce=["textContent"],re=["textContent"],me=P({__name:"[payoutId]",setup(d){const{t:e}=V(),{LIKE_CO_API:B}=j().public,R=z(),{token:E}=q(R),M=J(),y=_({}),I=_([]),O=_(""),m=_(!1),g=_(M.params.payoutId),v=_(""),T=D({get:()=>!!v.value,set:s=>{s||(v.value="")}});W(m,s=>{s&&(O.value="")});const w=D(()=>{if(!y.value)return[];const{id:s,createdTs:o,amount:i,status:t,currency:c,arrivalTs:r}=y.value;return[{id:s,createdTs:new Date(o*1e3).toLocaleString(),amount:N(i,c),status:t,currency:x(c),arrivalTs:r?new Date(r*1e3).toLocaleString():""}]}),K=D(()=>I.value.map(s=>{const{commissionId:o,createdTs:i,amount:t,currency:c,description:r,status:h,metadata:f}=s;return{commissionId:o,createdTs:new Date(i*1e3).toLocaleString(),amount:N(t,c),currency:x(c),description:r,status:h,metadata:JSON.stringify(f,null,2)}}));Y(async()=>{try{m.value=!0;const s=await $fetch(`${B}/likernft/book/user/payouts/${g.value}`,{headers:{authorization:`Bearer ${E.value}`}});y.value=s,y.value.items&&(I.value=y.value.items)}finally{m.value=!1}});async function U(){if(!w.value.length)return;const s=new Date().toISOString().split("T")[0],o=[{accessorKey:"id",header:e("table.id")},{accessorKey:"createdTs",header:e("table.created")},{accessorKey:"amount",header:e("table.payout_amount")},{accessorKey:"currency",header:e("table.currency")},{accessorKey:"status",header:e("table.status")},{accessorKey:"arrivalTs",header:e("table.arrived")}],{id:i,createdTs:t,amount:c,currency:r,status:h,arrivalTs:f}=y.value,p=[{id:i,createdTs:new Date(t*1e3).toLocaleString(),currency:x(r),amount:k(c,r),status:h,arrivalTs:f?new Date(f*1e3).toLocaleString():""}];await L(p,o,`payout-details-${g.value}-${s}.csv`)}async function A(){if(!K.value.length)return;const s=new Date().toISOString().split("T")[0],o=[{accessorKey:"commissionId",header:e("table.id")},{accessorKey:"createdTs",header:e("table.created")},{accessorKey:"amount",header:e("table.commission_amount")},{accessorKey:"currency",header:e("table.currency")},{accessorKey:"description",header:e("common.description")},{accessorKey:"status",header:e("table.status")},{accessorKey:"metadata",header:e("table.metadata")}],i=I.value.map(t=>({commissionId:t.commissionId,createdTs:new Date(t.createdTs*1e3).toLocaleString(),currency:x(t.currency),amount:k(t.amount,t.currency),description:t.description||"",status:t.status,metadata:t.metadata?JSON.stringify(t.metadata,null,2):""}));await L(i,o,`payout-items-${g.value}-${s}.csv`)}return(s,o)=>{const i=F,t=H,c=ee,r=G,h=X,f=ae;return $(),S(f,{class:"space-y-10 pb-10"},{default:n(()=>[b("div",te,[b("h1",se,u(a(e)("user_settings.payout_details"))+" - "+u(a(g)),1)]),a(m)?($(),S(i,{key:0,animation:"carousel"},{indicator:n(()=>[C(u(a(e)("loading.progress")),1)]),_:1})):Q("",!0),l(r,{ui:{header:"flex justify-between items-center",body:"p-0"}},{header:n(()=>[b("h3",oe,u(a(e)("user_settings.payout_details")),1),l(t,{icon:"i-heroicons-arrow-down-tray",variant:"outline",size:"sm",disabled:a(m)||!a(w).length,onClick:U},{default:n(()=>[C(u(a(e)("common.export_csv",{length:a(w).length})),1)]),_:1},8,["disabled"])]),default:n(()=>[l(c,{columns:[{accessorKey:"id",header:a(e)("table.id")},{accessorKey:"createdTs",header:a(e)("table.created")},{accessorKey:"currency",header:a(e)("table.currency")},{accessorKey:"amount",header:a(e)("table.payout_amount")},{accessorKey:"status",header:a(e)("table.status")},{accessorKey:"arrivalTs",header:a(e)("table.arrived")}],data:a(w),loading:a(m),ui:{th:"text-center",td:"text-center"}},null,8,["columns","data","loading"])]),_:1}),l(r,{ui:{body:"p-0",header:"flex justify-between items-center"}},{header:n(()=>[b("h3",ne,u(a(e)("user_settings.payout_details")),1),l(t,{icon:"i-heroicons-arrow-down-tray",variant:"outline",size:"sm",disabled:a(m)||!a(K).length,onClick:A},{default:n(()=>[C(u(a(e)("common.export_csv",{length:a(K).length})),1)]),_:1},8,["disabled"])]),default:n(()=>[l(c,{columns:[{accessorKey:"commissionId",header:a(e)("table.id")},{accessorKey:"createdTs",header:a(e)("table.created")},{accessorKey:"currency",header:a(e)("table.currency")},{accessorKey:"amount",header:a(e)("table.commission_amount")},{accessorKey:"description",header:a(e)("common.description")},{accessorKey:"status",header:a(e)("table.status")},{accessorKey:"metadata",header:a(e)("table.metadata")}],data:a(K),loading:a(m),ui:{th:"text-center",td:"text-center"}},{"metadata-cell":n(({row:p})=>[l(t,{label:a(e)("buttons.view_edit"),color:"neutral",onClick:de=>v.value=p.original.metadata},null,8,["label","onClick"])]),_:1},8,["columns","data","loading"])]),_:1}),l(h,{open:a(T),"onUpdate:open":o[1]||(o[1]=p=>Z(T)?T.value=p:null)},{header:n(()=>[b("h4",{class:"font-mono font-bold",textContent:u(a(e)("table.metadata"))},null,8,ce),l(t,{color:"neutral",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",square:"",onClick:o[0]||(o[0]=p=>T.value=!1)})]),body:n(()=>[b("pre",{textContent:u(a(v))},null,8,re)]),_:1},8,["open"])]),_:1})}}});export{me as default};
