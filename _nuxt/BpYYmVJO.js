import{H as l}from"./TL8mggxM.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"cd189bad150b481aa5ecb2e95de26ec677010e55"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c3bb79c7-6529-4b0b-bb56-b0ed21fc191a",e._sentryDebugIdIdentifier="sentry-dbid-c3bb79c7-6529-4b0b-bb56-b0ed21fc191a")})()}catch{}var d=(e=>(e.Start="magic_oauth_login_with_redirect_start",e.Verify="magic_oauth_login_with_redirect_verify",e.Popup="magic_oauth_login_with_popup",e.VerifyTelegramData="magic_oauth_verify_telegram_data",e))(d||{}),c=(e=>(e.InvalidRequest="invalid_request",e.InvalidClient="invalid_client",e.InvalidScope="invalid_scope",e.InvalidGrant="invalid_grant",e.UnauthorizedClient="unauthorized_client",e.UnsupportedResponseType="unsupported_response_type",e.UnsupportedGrantType="unsupported_grant_type",e.UnsupportedTokenType="unsupported_token_type",e.AccessDenied="access_denied",e.ServerError="server_error",e.TemporarilyUnavailable="temporarily_unavailable",e))(c||{}),h=class extends l.Internal{name="oauth2";config={};compat={"magic-sdk":">=2.4.6","@magic-sdk/react-native":!1,"@magic-sdk/react-native-bare":!1,"@magic-sdk/react-native-expo":!1};constructor(){super(),this.seamlessTelegramLogin()}loginWithRedirect(e){return this.utils.createPromiEvent(async(t,i)=>{let s=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_start",[{...e,apiKey:this.sdk.apiKey,platform:"web"}]),n=await this.request(s),r=n,o=n;if(o.error&&i(this.createError(o.error,o.error_description??"An error occurred.",{errorURI:o.error_uri,provider:o.provider})),r?.oauthAuthoriationURI){let a=r.useMagicServerCallback?new URL(r.oauthAuthoriationURI,this.sdk.endpoint).href:r.oauthAuthoriationURI;r?.shouldReturnURI?t(a):window.location.href=a}t(null)})}getRedirectResult(e){let t=e.optionalQueryString||window.location.search,i=window.location.origin+window.location.pathname;return window.history.replaceState(null,"",i),u.call(this,e,t)}loginWithPopup(e){let t=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_popup",[{...e,apiKey:this.sdk.apiKey,platform:"web"}]);return this.request(t)}seamlessTelegramLogin(){try{if(!window.location.hash.toString().includes("#tgWebAppData"))return;let e=document.createElement("script");e.src="https://telegram.org/js/telegram-web-app.js",document.head.prepend(e),e.onload=async()=>{try{let t=window.Telegram?.WebApp.initData,i=this.utils.createJsonRpcRequestPayload("magic_oauth_verify_telegram_data",[{userData:t,isMiniApp:!0}]);await this.request(i)}catch(t){console.log("Error while verifying telegram data",t)}}}catch(e){console.log("Error while loading telegram-web-app script",e)}}};function u(e,t){return this.utils.createPromiEvent(async(i,s)=>{let n=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_verify",[{authorizationResponseParams:t,magicApiKey:this.sdk.apiKey,platform:"web",...e}]),r=await this.request(n),o=r,a=r;a.error&&s(this.createError(a.error,a.error_description??"An error occurred.",{errorURI:a.error_uri,provider:a.provider})),i(o)})}export{c as OAuthErrorCode,h as OAuthExtension,d as OAuthPayloadMethods};
