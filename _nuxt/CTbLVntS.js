(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"cd189bad150b481aa5ecb2e95de26ec677010e55"}}catch{}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new n.Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="0bd701ff-a1dc-4efa-8fe9-0ed879ad7a08",n._sentryDebugIdIdentifier="sentry-dbid-0bd701ff-a1dc-4efa-8fe9-0ed879ad7a08")})()}catch{}function l(n,e){return new RegExp((e?"":"^")+"(?:"+n.join("|")+")"+(e?"$":"\\b"))}function o(n,e,r){return r.tokenize.push(n),n(e,r)}var F=/^(?:[-+/%|&^]|\*\*?|[<>]{2})/,w=/^(?:[=!]~|===|<=>|[<>=!]=?|[|&]{2}|~)/,g=/^(?:\[\][?=]?)/,I=/^(?:\.(?:\.{2})?|->|[?:])/,d=/^[a-z_\u009F-\uFFFF][a-zA-Z0-9_\u009F-\uFFFF]*/,h=/^[A-Z_\u009F-\uFFFF][a-zA-Z0-9_\u009F-\uFFFF]*/,x=l(["abstract","alias","as","asm","begin","break","case","class","def","do","else","elsif","end","ensure","enum","extend","for","fun","if","include","instance_sizeof","lib","macro","module","next","of","out","pointerof","private","protected","rescue","return","require","select","sizeof","struct","super","then","type","typeof","uninitialized","union","unless","until","when","while","with","yield","__DIR__","__END_LINE__","__FILE__","__LINE__"]),E=l(["true","false","nil","self"]),T=["def","fun","macro","class","module","struct","lib","enum","union","do","for"],S=l(T),A=["if","unless","case","while","until","begin","then"],D=l(A),z=["end","else","elsif","rescue","ensure"],O=l(z),s=["\\)","\\}","\\]"],K=new RegExp("^(?:"+s.join("|")+")$"),_={def:b,fun:b,macro:N,class:c,module:c,struct:c,lib:c,enum:c,union:c},k={"[":"]","{":"}","(":")","<":">"};function v(n,e){if(n.eatSpace())return null;if(e.lastToken!="\\"&&n.match("{%",!1))return o(f("%","%"),n,e);if(e.lastToken!="\\"&&n.match("{{",!1))return o(f("{","}"),n,e);if(n.peek()=="#")return n.skipToEnd(),"comment";var r;if(n.match(d))return n.eat(/[?!]/),r=n.current(),n.eat(":")?"atom":e.lastToken=="."?"property":x.test(r)?(S.test(r)?!(r=="fun"&&e.blocks.indexOf("lib")>=0)&&!(r=="def"&&e.lastToken=="abstract")&&(e.blocks.push(r),e.currentIndent+=1):(e.lastStyle=="operator"||!e.lastStyle)&&D.test(r)?(e.blocks.push(r),e.currentIndent+=1):r=="end"&&(e.blocks.pop(),e.currentIndent-=1),_.hasOwnProperty(r)&&e.tokenize.push(_[r]),"keyword"):E.test(r)?"atom":"variable";if(n.eat("@"))return n.peek()=="["?o(p("[","]","meta"),n,e):(n.eat("@"),n.match(d)||n.match(h),"propertyName");if(n.match(h))return"tag";if(n.eat(":"))return n.eat('"')?o(y('"',"atom",!1),n,e):n.match(d)||n.match(h)||n.match(F)||n.match(w)||n.match(g)?"atom":(n.eat(":"),"operator");if(n.eat('"'))return o(y('"',"string",!0),n,e);if(n.peek()=="%"){var i="string",u=!0,t;if(n.match("%r"))i="string.special",t=n.next();else if(n.match("%w"))u=!1,t=n.next();else if(n.match("%q"))u=!1,t=n.next();else if(t=n.match(/^%([^\w\s=])/))t=t[1];else{if(n.match(/^%[a-zA-Z_\u009F-\uFFFF][\w\u009F-\uFFFF]*/))return"meta";if(n.eat("%"))return"operator"}return k.hasOwnProperty(t)&&(t=k[t]),o(y(t,i,u),n,e)}return(r=n.match(/^<<-('?)([A-Z]\w*)\1/))?o(R(r[2],!r[1]),n,e):n.eat("'")?(n.match(/^(?:[^']|\\(?:[befnrtv0'"]|[0-7]{3}|u(?:[0-9a-fA-F]{4}|\{[0-9a-fA-F]{1,6}\})))/),n.eat("'"),"atom"):n.eat("0")?(n.eat("x")?n.match(/^[0-9a-fA-F_]+/):n.eat("o")?n.match(/^[0-7_]+/):n.eat("b")&&n.match(/^[01_]+/),"number"):n.eat(/^\d/)?(n.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+-]?\d+)?/),"number"):n.match(F)?(n.eat("="),"operator"):n.match(w)||n.match(I)?"operator":(r=n.match(/[({[]/,!1))?(r=r[0],o(p(r,k[r],null),n,e)):n.eat("\\")?(n.next(),"meta"):(n.next(),null)}function p(n,e,r,i){return function(u,t){if(!i&&u.match(n))return t.tokenize[t.tokenize.length-1]=p(n,e,r,!0),t.currentIndent+=1,r;var a=v(u,t);return u.current()===e&&(t.tokenize.pop(),t.currentIndent-=1,a=r),a}}function f(n,e,r){return function(i,u){return!r&&i.match("{"+n)?(u.currentIndent+=1,u.tokenize[u.tokenize.length-1]=f(n,e,!0),"meta"):i.match(e+"}")?(u.currentIndent-=1,u.tokenize.pop(),"meta"):v(i,u)}}function N(n,e){if(n.eatSpace())return null;var r;if(r=n.match(d)){if(r=="def")return"keyword";n.eat(/[?!]/)}return e.tokenize.pop(),"def"}function b(n,e){return n.eatSpace()?null:(n.match(d)?n.eat(/[!?]/):n.match(F)||n.match(w)||n.match(g),e.tokenize.pop(),"def")}function c(n,e){return n.eatSpace()?null:(n.match(h),e.tokenize.pop(),"def")}function y(n,e,r){return function(i,u){for(var t=!1;i.peek();)if(t)i.next(),t=!1;else{if(i.match("{%",!1))return u.tokenize.push(f("%","%")),e;if(i.match("{{",!1))return u.tokenize.push(f("{","}")),e;if(r&&i.match("#{",!1))return u.tokenize.push(p("#{","}","meta")),e;var a=i.next();if(a==n)return u.tokenize.pop(),e;t=r&&a=="\\"}return e}}function R(n,e){return function(r,i){if(r.sol()&&(r.eatSpace(),r.match(n)))return i.tokenize.pop(),"string";for(var u=!1;r.peek();)if(u)r.next(),u=!1;else{if(r.match("{%",!1))return i.tokenize.push(f("%","%")),"string";if(r.match("{{",!1))return i.tokenize.push(f("{","}")),"string";if(e&&r.match("#{",!1))return i.tokenize.push(p("#{","}","meta")),"string";u=r.next()=="\\"&&e}return"string"}}const Z={name:"crystal",startState:function(){return{tokenize:[v],currentIndent:0,lastToken:null,lastStyle:null,blocks:[]}},token:function(n,e){var r=e.tokenize[e.tokenize.length-1](n,e),i=n.current();return r&&r!="comment"&&(e.lastToken=i,e.lastStyle=r),r},indent:function(n,e,r){return e=e.replace(/^\s*(?:\{%)?\s*|\s*(?:%\})?\s*$/g,""),O.test(e)||K.test(e)?r.unit*(n.currentIndent-1):r.unit*n.currentIndent},languageData:{indentOnInput:l(s.concat(z),!0),commentTokens:{line:"#"}}};export{Z as crystal};
