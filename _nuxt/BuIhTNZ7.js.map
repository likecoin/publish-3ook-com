{"version":3,"file":"BuIhTNZ7.js","sources":["../../../pages/sales-pos/index.vue"],"sourcesContent":["<template>\n  <PageContainer :key=\"route.path\">\n    <PageHeader :title=\"pageTitle\" />\n    <PageBody\n      :ui=\"{\n        base: 'flex flex-col items-stretch grow space-y-4',\n        padding: 'max-md:px-0! max-md:py-0',\n      }\"\n    >\n      <UCard\n        class=\"max-md:rounded-none\"\n        :ui=\"{\n          root: 'flex flex-col grow',\n          header: 'flex justify-between items-center gap-4',\n          body: 'grow p-0',\n          footer: 'sticky bottom-0 bg-white dark:bg-gray-900 rounded-b-[inherit] px-0 sm:px-0 space-y-4',\n        }\"\n      >\n        <template #header>\n          <div class=\"flex items-center gap-2\">\n            <h2\n              class=\"text-xl font-bold\"\n              v-text=\"$t('sales_pos.sales_items') + (selectedItems.length > 0 ? $t('sales_pos.selected_count', { count: selectedItems.length }) : '')\"\n            />\n\n            <UButton\n              icon=\"i-heroicons-plus-circle\"\n              variant=\"soft\"\n              @click=\"toggleAddItemModal\"\n            />\n          </div>\n\n          <UDropdownMenu\n            :items=\"dropdownMenuItems\"\n            :popper=\"{ placement: 'bottom-end' }\"\n          >\n            <UButton color=\"neutral\" variant=\"outline\" icon=\"i-heroicons-ellipsis-horizontal-circle\" />\n          </UDropdownMenu>\n        </template>\n\n        <UTable\n          :columns=\"saleItemTableColumns\"\n          :data=\"saleItemTableRows\"\n          :ui=\"{ root: 'static h-full', thead: 'sticky top-0' }\"\n          @select=\"(row: TableRow<SaleItem>) => {\n            const idx = selectedSaleItemTableRows.findIndex(r => r.index === row.original.index)\n            if (idx >= 0) {\n              selectedSaleItemTableRows.splice(idx, 1)\n            } else {\n              selectedSaleItemTableRows.push(row.original)\n            }\n          }\"\n        >\n          <template #name-cell=\"{ row }\">\n            <div class=\"flex items-start gap-4\">\n              <img\n                v-if=\"row.original.image\"\n                class=\"w-[64px] object-contain rounded-sm\"\n                :src=\"row.original.image\"\n                alt=\"Item image\"\n              >\n\n              <div class=\"flex flex-col justify-start\">\n                <div class=\"whitespace-break-spaces\" v-text=\"row.original.name\" />\n\n                <USelect\n                  v-if=\"!!row.original.classId && (row.original.prices?.length ?? 0) > 1\"\n                  class=\"mt-2\"\n                  :model-value=\"saleItemList[row.original.index]?.priceIndex || 0\"\n                  :items=\"getPriceSelectItems(row.original.prices)\"\n                  @update:model-value=\"changePriceIndex($event, row.original)\"\n                />\n              </div>\n            </div>\n          </template>\n          <template #delete-action-header>\n            <div class=\"text-center\">\n              <UIcon name=\"i-heroicons-trash-solid\" />\n            </div>\n          </template>\n          <template #delete-action-cell=\"{ row }\">\n            <UButton\n              icon=\"i-heroicons-x-mark\"\n              color=\"error\"\n              variant=\"link\"\n              @click=\"removeSaleItem(row.original)\"\n            />\n          </template>\n        </UTable>\n\n        <template #footer>\n          <div class=\"flex items-center gap-2 px-4 sm:px-6\">\n            <USelect\n              v-model=\"selectedCouponCode\"\n              class=\"grow\"\n              :items=\"coupons.map(coupon => ({\n                label: coupon.name,\n                value: coupon.code\n              }))\"\n              :placeholder=\"$t('sales_pos.select_coupon')\"\n            />\n\n            <UButton\n              v-if=\"selectedCouponCode\"\n              icon=\"i-heroicons-x-mark-16-solid\"\n              size=\"sm\"\n              color=\"neutral\"\n              variant=\"outline\"\n              @click=\"() => { selectedCouponCode = '' }\"\n            />\n          </div>\n\n          <USeparator />\n\n          <UTabs\n            class=\"w-full\"\n            :items=\"[\n              { value: 'direct', label: $t('sales_pos.direct_checkout') },\n            ]\"\n            :ui=\"{\n              root: 'px-4 sm:px-6',\n              content: 'flex flex-col space-y-4'\n            }\"\n          >\n            <template #content=\"{ item }\">\n              <template v-if=\"item.value === 'direct'\">\n                <UFormField :label=\"$t('sales_pos.checkout_url')\">\n                  <div class=\"flex items-center gap-2\">\n                    <UInput\n                      v-model=\"checkoutUrl\"\n                      class=\"grow font-mono\"\n                      readonly\n                    />\n                    <UButton\n                      icon=\"i-heroicons-clipboard-document\"\n                      variant=\"soft\"\n                      color=\"neutral\"\n                      @click=\"copyCartUrl\"\n                    />\n                  </div>\n                </UFormField>\n\n                <div class=\"flex justify-center items-center gap-4\">\n                  <UButton\n                    :label=\"$t('sales_pos.view_cart')\"\n                    size=\"lg\"\n                    @click=\"goToCartUrl\"\n                  />\n\n                  <UButton\n                    :label=\"$t('sales_pos.generate_qr_code')\"\n                    :disabled=\"!selectedItems.length\"\n                    size=\"lg\"\n                    @click=\"generateQRCode\"\n                  />\n                  <UModal\n                    v-model:open=\"isOpenQRCodeModal\"\n                  >\n                    <template #content>\n                      <QRCodeGenerator\n                        :data=\"checkoutUrl\"\n                        mode=\"readonly\"\n                        file-name=\"likerland_checkout\"\n                        :width=\"280\"\n                        :height=\"280\"\n                      >\n                        <template #header>\n                          <h3 class=\"font-bold font-mono\" v-text=\"'Scan to buy'\" />\n                          <UButton\n                            icon=\"i-heroicons-x-mark\"\n                            color=\"neutral\"\n                            variant=\"ghost\"\n                            @click=\"isOpenQRCodeModal = false\"\n                          />\n                        </template>\n                      </QRCodeGenerator>\n                    </template>\n                  </UModal>\n                </div>\n              </template>\n            </template>\n          </UTabs>\n        </template>\n      </UCard>\n\n      <UModal v-model:open=\"isShowAddItemModal\">\n        <template #header>\n          <h3 class=\"font-bold font-mono\" v-text=\"'Add Item(s)'\" />\n\n          <UButton\n            icon=\"i-heroicons-x-mark\"\n            color=\"neutral\"\n            variant=\"link\"\n            @click=\"toggleAddItemModal\"\n          />\n        </template>\n\n        <template #body>\n          <div class=\"space-y-4\">\n            <UFormField\n              v-for=\"(input, index) in newProductIdInputs\"\n              :key=\"`input-${input.id}`\"\n              :label=\"$t('sales_pos.enter_product_id_urls')\"\n              :required=\"true\"\n              :error=\"input.error?.message\"\n            >\n              <div class=\"flex items-center gap-2\">\n                <UInput\n                  class=\"grow font-mono\"\n                  :model-value=\"input.value\"\n                  placeholder=\"https://3ook.com/store/0x....\"\n                  @update:model-value=\"handleNewItemInputUpdate(index, $event)\"\n                />\n\n                <UButton\n                  v-if=\"newProductIdInputs.length > 1\"\n                  icon=\"i-heroicons-x-circle\"\n                  variant=\"link\"\n                  @click=\"deleteNewItemInput(index)\"\n                />\n              </div>\n            </UFormField>\n\n            <div class=\"flex justify-center gap-4\">\n              <UButton\n                icon=\"i-heroicons-plus-circle\"\n                :label=\"$t('sales_pos.add')\"\n                variant=\"outline\"\n                @click=\"addNewItemInput\"\n              />\n            </div>\n          </div>\n        </template>\n\n        <template #footer>\n          <UButton\n            label=\"Confirm\"\n            @click=\"addSaleItem\"\n          />\n        </template>\n      </UModal>\n\n      <UModal v-model:open=\"isOpenNewCouponModal\">\n        <template #header>\n          <h3 class=\"font-bold\" v-text=\"'Add Coupon'\" />\n\n          <UButton\n            icon=\"i-heroicons-x-mark-16-solid\"\n            color=\"neutral\"\n            size=\"xl\"\n            variant=\"link\"\n            @click=\"isOpenNewCouponModal = false\"\n          />\n        </template>\n\n        <template #body>\n          <div class=\"space-y-4\">\n            <UFormField\n              label=\"Coupon Name\"\n              help=\"For POS Display Only\"\n              :required=\"true\"\n            >\n              <UInput\n                v-model=\"newCouponNameInput\"\n                placeholder=\"Fall Promotion\"\n              />\n            </UFormField>\n\n            <UFormField\n              label=\"Coupon Code\"\n              :required=\"true\"\n            >\n              <UInput\n                v-model=\"newCouponCodeInput\"\n                class=\"font-mono\"\n                placeholder=\"FALLPROMO\"\n              />\n            </UFormField>\n          </div>\n        </template>\n\n        <template #footer>\n          <UButton\n            icon=\"i-heroicons-plus-circle\"\n            label=\"Add Coupon\"\n            :disabled=\"!newCouponNameInput || !newCouponCodeInput\"\n            @click=\"addCouponCode\"\n          />\n        </template>\n      </UModal>\n    </PageBody>\n  </PageContainer>\n</template>\n\n<script setup lang=\"ts\">\nimport type { DropdownMenuItem, TableRow } from '#ui/types'\nconst { t: $t } = useI18n()\n\nconst route = useRoute()\nconst toast = useToast()\nconst { BOOK3_URL } = useRuntimeConfig().public\nconst nftStore = useNftStore()\n\nconst { lazyFetchClassMetadataById, lazyFetchClassListingInfoById } = nftStore\n\nconst newProductIdInputs = ref<{ id: number; value: string, error?: Error }[]>([{ id: 0, value: '' }])\nconst newProductIdInputNextId = ref(1)\n\nconst isOpenNewCouponModal = ref(false)\nconst newCouponNameInput = ref('')\nconst newCouponCodeInput = ref('')\nconst coupons = ref<{name: string, code: string}[]>([])\nconst selectedCouponCode = ref('')\n\nconst saleItemList = ref<{ classId: string; priceIndex?: number }[]>([])\nconst isShowAddItemModal = ref(false)\nconst isOpenQRCodeModal = ref(false)\nconst isEditMode = ref(false)\n\nwatch(isShowAddItemModal, (value) => {\n  if (!value) {\n    newProductIdInputs.value = [{ id: 0, value: '' }]\n    newProductIdInputNextId.value = 1\n  }\n})\n\nconst saleItemTableColumns = computed(() => {\n  const columns = [\n    { accessorKey: 'name', header: $t('common.name'), class: '' }\n  ]\n  if (isEditMode.value) {\n    columns.push({ accessorKey: 'delete-action', header: '', class: 'w-12' })\n  }\n  return columns\n})\n\nconst dropdownMenuItems = computed(() => {\n  const items: DropdownMenuItem[][] = []\n\n  if (saleItemTableRows.value.length) {\n    items.push([{\n      label: isEditMode.value ? 'Exit Edit Items' : 'Edit Items',\n      icon: isEditMode.value ? 'i-heroicons-pencil-solid' : 'i-heroicons-pencil',\n      onSelect: toggleEditMode\n    }])\n  }\n\n  items.push([\n    {\n      label: 'New Coupon',\n      icon: 'i-heroicons-tag',\n      onSelect: () => {\n        isOpenNewCouponModal.value = !isOpenNewCouponModal.value\n      }\n    },\n    {\n      class: 'text-red-500',\n      label: 'Clear All Coupons',\n      icon: 'i-heroicons-trash',\n      disabled: !coupons.value.length,\n      onSelect: clearAllCoupons\n    }\n  ])\n\n  return items\n})\n\ninterface SaleItem {\n  classId?: string;\n  prices?: Record<string, unknown>[];\n  name: string;\n  image: string;\n  index: number;\n}\n\nfunction getPriceSelectItems (prices?: Record<string, unknown>[]) {\n  if (!prices) { return [] }\n  return prices.map((price) => {\n    const name = price.name as { zh?: string; en?: string } | string | undefined\n    return {\n      label: (typeof name === 'object' ? (name?.zh || name?.en) : name) || '',\n      value: (price.index as number) || 0\n    }\n  })\n}\n\nconst saleItemTableRows = computed<SaleItem[]>(() => {\n  return saleItemList.value?.map((item, index) => {\n    const listingInfo = nftStore.getClassListingInfoById(item.classId)\n    const listingPrices = listingInfo?.prices as Record<string, unknown>[] | undefined\n    const metadata = nftStore.getClassMetadataById(item.classId)\n    const imageData = (metadata as Record<string, unknown> | undefined)?.data as Record<string, unknown> | undefined\n    const nestedMetadata = imageData?.metadata as Record<string, unknown> | undefined\n    return {\n      classId: item.classId,\n      name: metadata?.name || '',\n      prices: listingPrices?.map((price: Record<string, unknown>) => ({ ...price })),\n      image: parseImageURLFromMetadata((nestedMetadata?.image as string) || ''),\n      index\n    }\n  })\n})\nconst selectedSaleItemTableRows = ref<SaleItem[]>([])\n\nconst selectedItems = computed(() => {\n  const items = selectedSaleItemTableRows.value.map(row => saleItemList.value[row.index])\n  return items.sort((a, b) => {\n    if (a?.priceIndex !== undefined && !b?.priceIndex) {\n      return -1\n    } else if (!a?.priceIndex && b?.priceIndex !== undefined) {\n      return 1\n    } else {\n      return 0\n    }\n  })\n})\n\nwatch(saleItemTableRows, (rows) => {\n  if (!rows.length) {\n    isEditMode.value = false\n  }\n})\n\nconst checkoutUrl = computed(() => {\n  const params = new URLSearchParams({\n    utm_source: 'direct-checkout',\n    utm_medium: 'pos'\n  })\n  const productsString = selectedItems.value\n    .filter((item): item is { classId: string; priceIndex?: number } => !!item)\n    .map(({ classId, priceIndex }) => {\n      return `${classId}${priceIndex ? `:${priceIndex}` : ''}`\n    }).join(',')\n  params.append('products', productsString)\n  if (selectedCouponCode.value) {\n    params.append('coupon', selectedCouponCode.value)\n  }\n  return `${BOOK3_URL}/checkout?${params.toString()}`\n})\n\nconst pageTitle = computed(() => '3ook Point Of Sale')\nuseSeoMeta({\n  title: () => pageTitle.value,\n  ogTitle: () => pageTitle.value\n})\n\nonMounted(() => {\n  try {\n    const storedItemString = window.localStorage.getItem('nft_book_store_pos_items')\n    if (storedItemString) {\n      const items = JSON.parse(storedItemString)\n      saleItemList.value = items\n        .map((item: { classId: string; priceIndex?: number }) => ({\n          classId: item.classId,\n          priceIndex: item.priceIndex\n        }))\n    }\n    const storedCouponString = window.localStorage.getItem('nft_book_store_pos_coupons')\n    if (storedCouponString) {\n      const items = JSON.parse(storedCouponString)\n      coupons.value = items\n        .map((item: { name: string; code: string }) => ({\n          name: item.name,\n          code: item.code\n        }))\n    }\n  } catch (e) {\n    console.error(e)\n  }\n  saleItemList.value.forEach((item) => {\n    if (item.classId) {\n      lazyFetchClassMetadataById(item.classId)\n      lazyFetchClassListingInfoById(item.classId)\n    }\n  })\n})\n\nfunction addNewItemInput () {\n  if (newProductIdInputs.value.length) {\n    newProductIdInputs.value.push({ id: newProductIdInputNextId.value++, value: '' })\n  }\n}\n\nfunction deleteNewItemInput (index: number) {\n  newProductIdInputs.value.splice(index, 1)\n}\n\nfunction handleNewItemInputUpdate (index: number, value: string) {\n  const input = newProductIdInputs.value[index]\n  if (input) {\n    input.error = undefined\n    input.value = value\n  }\n}\n\nfunction addSaleItem () {\n  newProductIdInputs.value.forEach((input) => {\n    input.error = undefined\n    let productId = input.value.trim()\n    if (productId.startsWith('http')) {\n      const url = new URL(productId)\n      productId = url.pathname.split('/').pop() || ''\n    }\n    if (productId.startsWith('0x')) {\n      saleItemList.value.push({ classId: productId, priceIndex: 0 })\n      lazyFetchClassMetadataById(productId)\n      lazyFetchClassListingInfoById(productId)\n    } else {\n      input.error = new Error('Invalid product ID')\n    }\n  })\n  if (newProductIdInputs.value.every(input => !input.error)) {\n    isShowAddItemModal.value = false\n    saveSaleProductIds()\n  }\n}\n\nfunction changePriceIndex (value: number, { index }: { index: number }) {\n  const item = saleItemList.value[index]\n  if (item) {\n    item.priceIndex = Number(value)\n  }\n  saveSaleProductIds()\n}\n\nfunction removeSaleItem ({ index }: { index: number }) {\n  saleItemList.value.splice(index, 1)\n  selectedSaleItemTableRows.value = selectedSaleItemTableRows.value.filter(row => row.index !== index)\n  saveSaleProductIds()\n}\n\nfunction toggleAddItemModal () {\n  isShowAddItemModal.value = !isShowAddItemModal.value\n}\n\nfunction toggleEditMode () {\n  isEditMode.value = !isEditMode.value\n}\n\nfunction addCouponCode () {\n  coupons.value.push({ name: newCouponNameInput.value, code: newCouponCodeInput.value })\n  newCouponNameInput.value = ''\n  newCouponCodeInput.value = ''\n  saveSaleCoupons()\n  toast.add({\n    title: 'Added coupon',\n    duration: 2000,\n    color: 'success'\n  })\n  isOpenNewCouponModal.value = false\n}\n\nfunction clearAllCoupons () {\n  const isConfirm = window.confirm('Are you sure you want to clear all coupons?')\n  if (isConfirm) {\n    coupons.value = []\n    selectedCouponCode.value = ''\n    saveSaleCoupons()\n    toast.add({\n      title: 'Cleared all coupons',\n      duration: 2000,\n      color: 'error'\n    })\n  }\n}\n\nfunction saveSaleProductIds () {\n  window.localStorage.setItem('nft_book_store_pos_items', JSON.stringify(saleItemList.value))\n}\n\nfunction saveSaleCoupons () {\n  window.localStorage.setItem('nft_book_store_pos_coupons', JSON.stringify(coupons.value))\n}\n\nfunction copyCartUrl () {\n  toast.add({ title: 'Copied URL to clipboard', duration: 2000 })\n  navigator.clipboard.writeText(checkoutUrl.value)\n}\n\nfunction goToCartUrl () {\n  window.open(checkoutUrl.value)\n}\n\nfunction generateQRCode () {\n  isOpenQRCodeModal.value = true\n}\n\n</script>\n"],"names":["$t","useI18n","route","useRoute","toast","useToast","BOOK3_URL","useRuntimeConfig","nftStore","useNftStore","lazyFetchClassMetadataById","lazyFetchClassListingInfoById","newProductIdInputs","ref","newProductIdInputNextId","isOpenNewCouponModal","newCouponNameInput","newCouponCodeInput","coupons","selectedCouponCode","saleItemList","isShowAddItemModal","isOpenQRCodeModal","isEditMode","watch","value","saleItemTableColumns","computed","columns","dropdownMenuItems","items","saleItemTableRows","toggleEditMode","clearAllCoupons","getPriceSelectItems","prices","price","name","item","index","listingPrices","metadata","nestedMetadata","parseImageURLFromMetadata","selectedSaleItemTableRows","selectedItems","row","a","b","rows","checkoutUrl","params","productsString","classId","priceIndex","pageTitle","useSeoMeta","onMounted","storedItemString","storedCouponString","e","addNewItemInput","deleteNewItemInput","handleNewItemInputUpdate","input","addSaleItem","productId","saveSaleProductIds","changePriceIndex","removeSaleItem","toggleAddItemModal","addCouponCode","saveSaleCoupons","copyCartUrl","goToCartUrl","generateQRCode","_createBlock","_component_PageContainer","_unref","_createVNode","_component_PageHeader","_component_PageBody","_component_UCard","_createElementVNode","_hoisted_1","_toDisplayString","_component_UButton","_component_UDropdownMenu","_hoisted_8","_component_USelect","$event","coupon","_component_USeparator","_component_UTabs","_withCtx","_createElementBlock","_Fragment","_component_UFormField","_hoisted_9","_component_UInput","_hoisted_10","_component_UModal","_component_QRCodeGenerator","_component_UTable","idx","r","_hoisted_3","_hoisted_5","_hoisted_7","_component_UIcon","_hoisted_11","_openBlock","_renderList","_hoisted_12","_hoisted_13","_hoisted_14"],"mappings":"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"}