{"version":3,"file":"BP6cAPep.js","sources":["../../../pages/settings/connect/refresh.vue"],"sourcesContent":["<template>\n  <UModal :open=\"true\">\n    <template #header>\n      <h2 v-if=\"isLoading\" class=\"text-sm font-bold font-mono\">\n        Refreshing Stripe Connect Payout Account Status\n      </h2>\n      <h2 v-else-if=\"isDone && !error\" class=\"text-sm font-bold font-mono\">\n        Stripe Connect Account Status Refreshed\n      </h2>\n      <h2 v-else class=\"text-sm font-bold font-mono\">\n        An error occurred when refreshing the Stripe Connect Account Status\n      </h2>\n    </template>\n\n    <template #body>\n      <div v-if=\"isLoading\">\n        <UProgress animation=\"carousel\">\n          <template #indicator>\n            Refreshing...\n          </template>\n        </UProgress>\n      </div>\n\n      <div v-else-if=\"isDone && !error\">\n        <UProgress :value=\"100\">\n          <template #indicator>\n            Refreshed! Redirect back in 3 seconds...\n          </template>\n        </UProgress>\n      </div>\n\n      <div v-else class=\"space-y-4\">\n        <UProgress :value=\"100\" color=\"error\" />\n\n        <UAlert\n          icon=\"i-heroicons-exclamation-triangle\"\n          color=\"error\"\n          variant=\"soft\"\n          :title=\"error || 'Unknown error'\"\n        />\n      </div>\n    </template>\n\n    <template v-if=\"!isLoading && !isDone\" #footer>\n      <UButton\n        label=\"Go Back\"\n        :to=\"localeRoute({ name: 'settings' })\"\n      />\n    </template>\n  </UModal>\n</template>\n\n<script setup lang=\"ts\">\nconst { LIKE_CO_API } = useRuntimeConfig().public\n\nconst localeRoute = useLocaleRoute()\nconst bookstoreApiStore = useBookstoreApiStore()\nconst { token } = storeToRefs(bookstoreApiStore)\n\nconst error = ref('')\nconst isLoading = ref(false)\nconst isDone = ref(false)\n\ndefinePageMeta({\n  layout: 'page'\n})\n\nwatch(isLoading, (newIsLoading) => {\n  if (newIsLoading) { error.value = '' }\n})\n\nonMounted(async () => {\n  try {\n    isLoading.value = true\n    const data = await $fetch(`${LIKE_CO_API}/likernft/book/user/connect/refresh`,\n      {\n        method: 'POST',\n        headers: {\n          authorization: `Bearer ${token.value}`\n        }\n      }\n    )\n    isDone.value = (data as { isReady?: boolean }).isReady || false\n\n    setTimeout(async () => {\n      await navigateTo(localeRoute({ name: 'settings' }), { replace: true })\n    }, 3000)\n  } catch (e) {\n    console.error(e)\n    error.value = (e as Error).toString()\n  } finally {\n    isLoading.value = false\n  }\n})\n</script>\n"],"names":["LIKE_CO_API","useRuntimeConfig","localeRoute","useLocaleRoute","bookstoreApiStore","useBookstoreApiStore","token","storeToRefs","error","ref","isLoading","isDone","watch","newIsLoading","onMounted","data","navigateTo","e","_createBlock","_component_UModal","_createSlots","_unref","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_createVNode","_component_UProgress","_cache","_hoisted_5","_openBlock","_hoisted_6","_component_UAlert","_component_UButton"],"mappings":"w7BAqDA,KAAM,CAAE,YAAAA,CAAA,EAAgBC,EAAA,EAAmB,OAErCC,EAAcC,EAAA,EACdC,EAAoBC,EAAA,EACpB,CAAE,MAAAC,CAAA,EAAUC,EAAYH,CAAiB,EAEzCI,EAAQC,EAAI,EAAE,EACdC,EAAYD,EAAI,EAAK,EACrBE,EAASF,EAAI,EAAK,EAMxB,OAAAG,EAAMF,EAAYG,GAAiB,CAC7BA,IAAgBL,EAAM,MAAQ,GACpC,CAAC,EAEDM,EAAU,SAAY,CACpB,GAAI,CACFJ,EAAU,MAAQ,GAClB,MAAMK,EAAO,MAAM,OAAO,GAAGf,CAAW,sCACtC,CACE,OAAQ,OACR,QAAS,CACP,cAAe,UAAUM,EAAM,KAAK,EAAA,CACtC,CACF,EAEFK,EAAO,MAASI,EAA+B,SAAW,GAE1D,WAAW,SAAY,CACrB,MAAMC,EAAWd,EAAY,CAAE,KAAM,UAAA,CAAY,EAAG,CAAE,QAAS,GAAM,CACvE,EAAG,GAAI,CACT,OAASe,EAAG,CACV,QAAQ,MAAMA,CAAC,EACfT,EAAM,MAASS,EAAY,SAAA,CAC7B,QAAA,CACEP,EAAU,MAAQ,EACpB,CACF,CAAC,2CA5FCQ,EAgDSC,EAAA,CAhDA,KAAM,EAAA,EAAIC,EAAA,CACN,SACT,IAEK,CAFKC,EAAAX,CAAA,OAAVY,EAEK,KAFLC,EAAyD,mDAEzD,GACeF,EAAAV,CAAA,IAAWU,EAAAb,CAAA,OAA1Bc,EAEK,KAFLE,EAAqE,2CAErE,QACAF,EAEK,KAFLG,EAA+C,uEAE/C,EAAA,GAGS,OACT,IAMM,CANKJ,EAAAX,CAAA,OAAXY,EAMM,MAAAI,EAAA,CALJC,EAIYC,EAAA,CAJD,UAAU,YAAU,CAClB,YAAU,IAErB,CAAA,GAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFqB,kBAErB,EAAA,CAAA,cAIYR,EAAAV,CAAA,IAAWU,EAAAb,CAAA,OAA3Bc,EAMM,MAAAQ,EAAA,CALJH,EAIYC,EAAA,CAJA,MAAO,KAAG,CACT,YAAU,IAErB,CAAA,GAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFqB,6CAErB,EAAA,CAAA,eAIJE,EAAA,EAAAT,EASM,MATNU,EASM,CARJL,EAAwCC,EAAA,CAA5B,MAAO,IAAK,MAAM,OAAA,GAE9BD,EAKEM,EAAA,CAJA,KAAK,mCACL,MAAM,QACN,QAAQ,OACP,MAAOZ,EAAAb,CAAA,GAAK,eAAA,+BAKF,CAAAa,EAAAX,CAAA,IAAcW,EAAAV,CAAA,QAAS,cACtC,IAGE,CAHFgB,EAGEO,EAAA,CAFA,MAAM,UACL,GAAIb,EAAAnB,CAAA,EAAW,CAAA,KAAA,WAAA,CAAA"}