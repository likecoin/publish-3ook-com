import{g as P,a as U,Q as D,b as z,s as C,w as V,o as j,l as f,m as u,n as _,W as p,q as t,e as x,X as G,c as g,Y as M,L as T,C as W,p as m,M as k,a1 as Y,a7 as q}from"./9S2XGRg9.js";import{_ as K}from"./CLuOJMie.js";import{u as Q}from"./DOPoUBoe.js";import{u as X}from"./Do2UJywV.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"cd189bad150b481aa5ecb2e95de26ec677010e55"}}catch{}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new n.Error().stack;r&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[r]="e4bbc869-8e55-4a08-8f7d-a76301d99c76",n._sentryDebugIdIdentifier="sentry-dbid-e4bbc869-8e55-4a08-8f7d-a76301d99c76")})()}catch{}const F={class:"text-center font-bold font-mono"},H={class:"flex flex-col justify-center items-center gap-4"},J=["textContent"],ae=P({__name:"index",setup(n){const{LIKE_CO_API:r}=U().public,{t:i}=D(),v=z(),h=Q(),{token:b,wallet:y}=C(v),{getStripeConnectStatusByWallet:E}=C(h),{showErrorToast:d}=X(),a=x(""),o=x(!1);V(o,e=>{e&&(a.value="")}),j(async()=>{await h.refreshStripeConnectStatus(y.value)});const l=g(()=>E.value(y.value)),c=g(()=>l.value?.isReady),A=g(()=>{if(!l.value?.hasAccount&&!c.value)return i("user_settings.setup_stripe_connect");if(l.value?.hasAccount&&!c.value)return i("user_settings.resume_stripe_connect_setup");if(l.value?.hasAccount&&c.value)return i("user_settings.login_to_stripe")});async function $(){try{o.value=!0,await h.refreshStripeConnectStatus(y.value)}catch(e){a.value=e.toString(),d(e.toString())}finally{o.value=!1}}async function N(){try{o.value=!0;const s=(await $fetch(`${r}/likernft/book/user/connect/login`,{method:"POST",headers:{authorization:`Bearer ${b.value}`}})).url;if(s)window.open(s);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString(),d(e.toString())}finally{o.value=!1}}async function B(){try{o.value=!0;const s=(await $fetch(`${r}/likernft/book/user/connect/new`,{method:"POST",headers:{authorization:`Bearer ${b.value}`}})).url;if(s)window.open(s);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString(),d(e.toString())}finally{o.value=!1}}async function R(){o.value=!0;try{c.value?await N():await B()}catch(e){console.error(e),a.value=e.toString(),d(e.toString())}finally{o.value=!1}}return(e,s)=>{const S=G,w=Y,I=q,L=M,O=K;return u(),f(O,null,{default:_(()=>[t(a)?(u(),f(S,{key:0,icon:"i-heroicons-exclamation-triangle",color:"error",variant:"soft",title:`${t(a)}`,close:{icon:"i-heroicons-x-mark-20-solid",color:"error",variant:"link"},onClose:s[0]||(s[0]=Z=>a.value="")},null,8,["title"])):p("",!0),t(c)?p("",!0):(u(),f(S,{key:1,icon:"i-heroicons-exclamation-circle",color:"warning",variant:"soft",title:t(i)("user_settings.stripe_express_notice"),description:t(i)("user_settings.stripe_express_description")},null,8,["title","description"])),t(v).isAuthenticated?(u(),f(L,{key:2,ui:{header:"flex justify-between items-center",body:"p-0",footer:"text-center"}},{header:_(()=>[T("h1",F,k(t(i)("user_settings.stripe_payout_status")),1),m(I,{text:"Refresh Status",popper:{placement:"left"}},{default:_(()=>[m(w,{icon:"i-heroicons-arrow-path",variant:"outline",disabled:t(o),onClick:$},null,8,["disabled"])]),_:1})]),footer:_(()=>[T("div",H,[t(l)?.hasAccount&&t(c)?(u(),W("span",{key:0,class:"text-sm text-gray-500",textContent:k(t(l).email)},null,8,J)):p("",!0),m(w,{label:t(A),size:"md",loading:t(o),disabled:t(o),color:"neutral",variant:"solid",onClick:R},null,8,["label","loading","disabled"])])]),_:1})):p("",!0)]),_:1})}}});export{ae as default};
