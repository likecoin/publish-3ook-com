{"version":3,"file":"BpYYmVJO.js","sources":["../../../node_modules/@magic-ext/oauth2/dist/es/index.mjs"],"sourcesContent":["import{Extension as g}from\"@magic-sdk/commons\";var p=(n=>(n.Start=\"magic_oauth_login_with_redirect_start\",n.Verify=\"magic_oauth_login_with_redirect_verify\",n.Popup=\"magic_oauth_login_with_popup\",n.VerifyTelegramData=\"magic_oauth_verify_telegram_data\",n))(p||{}),d=(i=>(i.InvalidRequest=\"invalid_request\",i.InvalidClient=\"invalid_client\",i.InvalidScope=\"invalid_scope\",i.InvalidGrant=\"invalid_grant\",i.UnauthorizedClient=\"unauthorized_client\",i.UnsupportedResponseType=\"unsupported_response_type\",i.UnsupportedGrantType=\"unsupported_grant_type\",i.UnsupportedTokenType=\"unsupported_token_type\",i.AccessDenied=\"access_denied\",i.ServerError=\"server_error\",i.TemporarilyUnavailable=\"temporarily_unavailable\",i))(d||{});var l=class extends g.Internal{name=\"oauth2\";config={};compat={\"magic-sdk\":\">=2.4.6\",\"@magic-sdk/react-native\":!1,\"@magic-sdk/react-native-bare\":!1,\"@magic-sdk/react-native-expo\":!1};constructor(){super(),this.seamlessTelegramLogin()}loginWithRedirect(r){return this.utils.createPromiEvent(async(e,o)=>{let n=this.utils.createJsonRpcRequestPayload(\"magic_oauth_login_with_redirect_start\",[{...r,apiKey:this.sdk.apiKey,platform:\"web\"}]),s=await this.request(n),a=s,t=s;if(t.error&&o(this.createError(t.error,t.error_description??\"An error occurred.\",{errorURI:t.error_uri,provider:t.provider})),a?.oauthAuthoriationURI){let u=a.useMagicServerCallback?new URL(a.oauthAuthoriationURI,this.sdk.endpoint).href:a.oauthAuthoriationURI;a?.shouldReturnURI?e(u):window.location.href=u}e(null)})}getRedirectResult(r){let e=r.optionalQueryString||window.location.search,o=window.location.origin+window.location.pathname;return window.history.replaceState(null,\"\",o),h.call(this,r,e)}loginWithPopup(r){let e=this.utils.createJsonRpcRequestPayload(\"magic_oauth_login_with_popup\",[{...r,apiKey:this.sdk.apiKey,platform:\"web\"}]);return this.request(e)}seamlessTelegramLogin(){try{if(!window.location.hash.toString().includes(\"#tgWebAppData\"))return;let e=document.createElement(\"script\");e.src=\"https://telegram.org/js/telegram-web-app.js\",document.head.prepend(e),e.onload=async()=>{try{let o=window.Telegram?.WebApp.initData,n=this.utils.createJsonRpcRequestPayload(\"magic_oauth_verify_telegram_data\",[{userData:o,isMiniApp:!0}]);await this.request(n)}catch(o){console.log(\"Error while verifying telegram data\",o)}}}catch(r){console.log(\"Error while loading telegram-web-app script\",r)}}};function h(c,r){return this.utils.createPromiEvent(async(e,o)=>{let n=this.utils.createJsonRpcRequestPayload(\"magic_oauth_login_with_redirect_verify\",[{authorizationResponseParams:r,magicApiKey:this.sdk.apiKey,platform:\"web\",...c}]),s=await this.request(n),a=s,t=s;t.error&&o(this.createError(t.error,t.error_description??\"An error occurred.\",{errorURI:t.error_uri,provider:t.provider})),e(a)})}export{d as OAuthErrorCode,l as OAuthExtension,p as OAuthPayloadMethods};\n//# sourceMappingURL=index.mjs.map\n"],"names":["p","n","d","i","l","g","r","e","o","s","a","t","u","h","c"],"mappings":"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"}