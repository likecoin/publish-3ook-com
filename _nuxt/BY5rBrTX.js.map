{"version":3,"file":"BY5rBrTX.js","sources":["../../../composables/useReadersTable.ts","../../../pages/readers/index.vue"],"sourcesContent":["import type { BookInfo, ReaderData } from '~/stores/orders'\n\nexport function useReadersTable () {\n  const { t } = useI18n()\n\n  const ordersStore = useOrdersStore()\n\n  const pagination = ref({\n    page: 1,\n    limit: 100,\n    total: 0\n  })\n\n  const sortState = ref<{\n    column: string | null\n    direction: 'asc' | 'desc' | null\n  }>({\n    column: null,\n    direction: null\n  })\n\n  const pageSizeOptions = [\n    { label: '25', value: 25 },\n    { label: '50', value: 50 },\n    { label: '100', value: 100 },\n    { label: '200', value: 200 }\n  ]\n\n  const selectedRows = ref<ReaderData[]>([])\n  const hasSelection = computed(() => selectedRows.value.length > 0)\n  const selectionCount = computed(() => selectedRows.value.length)\n\n  const baseColumnsConfig = computed(() => [\n    { key: 'readerEmail', label: t('table.reader_email'), accessorKey: 'readerEmail', header: t('table.reader_email') },\n    { key: 'readerWallet', label: t('table.reader_wallet'), accessorKey: 'readerWallet', header: t('table.reader_wallet') },\n    { key: 'firstPurchaseTime', label: t('table.first_purchase'), accessorKey: 'firstPurchaseTime', header: t('table.first_purchase') },\n    { key: 'lastPurchaseTime', label: t('table.last_purchase'), accessorKey: 'lastPurchaseTime', header: t('table.last_purchase') },\n    { key: 'lifetimeValue', label: t('table.lifetime_value'), accessorKey: 'lifetimeValue', header: t('table.lifetime_value') },\n    { key: 'hasMessage', label: t('table.has_message'), accessorKey: 'hasMessage', header: t('table.has_message') }\n  ])\n\n  const columns = computed(() => {\n    const baseColumns = baseColumnsConfig.value.map(col => ({\n      key: col.key,\n      label: col.label,\n      accessorKey: col.accessorKey,\n      header: col.header\n    }))\n\n    const bookColumns = Object.values(ordersStore.booksInfo).map((book: BookInfo) => ({\n      key: `book_${book.classId}`,\n      label: book.name?.slice(0, 1) || book.classId.slice(0, 1),\n      accessorKey: `book_${book.classId}`,\n      header: book.name?.slice(0, 1) || book.classId.slice(0, 1)\n    }))\n\n    return [...baseColumns, ...bookColumns]\n  })\n\n  const sortedReaders = computed(() => {\n    const readers = [...ordersStore.readers]\n\n    if (!sortState.value.column || !sortState.value.direction) {\n      return readers.sort((a, b) => b.lifetimeValue - a.lifetimeValue)\n    }\n\n    return readers.sort((a, b) => {\n      const aValue = a[sortState.value.column!]\n      const bValue = b[sortState.value.column!]\n\n      let comparison = 0\n\n      if (sortState.value.column!.includes('Time')) {\n        const aTime = new Date(aValue as string | number).getTime()\n        const bTime = new Date(bValue as string | number).getTime()\n        comparison = aTime - bTime\n      } else if (typeof aValue === 'string' && typeof bValue === 'string') {\n        comparison = aValue.localeCompare(bValue)\n      } else if (typeof aValue === 'number' && typeof bValue === 'number') {\n        comparison = aValue - bValue\n      } else if (typeof aValue === 'boolean' && typeof bValue === 'boolean') {\n        comparison = (aValue ? 1 : 0) - (bValue ? 1 : 0)\n      } else if (aValue == null && bValue == null) {\n        comparison = 0\n      } else if (aValue == null) {\n        comparison = -1\n      } else if (bValue == null) {\n        comparison = 1\n      } else {\n        comparison = String(aValue).localeCompare(String(bValue))\n      }\n\n      return sortState.value.direction === 'desc' ? -comparison : comparison\n    })\n  })\n\n  const paginatedReaders = computed(() => {\n    pagination.value.total = ordersStore.readers.length\n\n    const start = (pagination.value.page - 1) * pagination.value.limit\n    const end = start + pagination.value.limit\n    return sortedReaders.value.slice(start, end)\n  })\n\n  const totalPages = computed(() => {\n    return Math.ceil(pagination.value.total / pagination.value.limit)\n  })\n\n  function onSelect (rows: ReaderData[]) {\n    selectedRows.value = rows\n  }\n\n  function clearSelection () {\n    selectedRows.value = []\n  }\n\n  function formatDate (dateString: string | number, locale = 'zh-TW'): string {\n    if (!dateString) { return '-' }\n\n    const date = new Date(dateString)\n    if (isNaN(date.getTime())) { return '-' }\n\n    return date.toLocaleDateString(locale, {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit'\n    })\n  }\n\n  function formatValue (amount: number, decimals = 2): string {\n    if (typeof amount !== 'number' || isNaN(amount)) { return '0.00' }\n    return `${amount.toFixed(decimals)}`\n  }\n\n  function setSortState (column: string | null, direction: 'asc' | 'desc' | null) {\n    sortState.value.column = column\n    sortState.value.direction = direction\n  }\n\n  function setPage (page: number) {\n    const maxPage = Math.ceil(pagination.value.total / pagination.value.limit)\n    pagination.value.page = Math.max(1, Math.min(page, maxPage))\n  }\n\n  function setPageSize (limit: number) {\n    pagination.value.limit = limit\n    pagination.value.page = 1 // Reset to first page\n  }\n\n  function shortenWallet (wallet: string, startLength = 6, endLength = 4): string {\n    if (!wallet) { return '' }\n    if (wallet.length <= startLength + endLength) { return wallet }\n\n    return `${wallet.slice(0, startLength)}...${wallet.slice(-endLength)}`\n  }\n\n  function getWalletLink (wallet: string): string {\n    if (!wallet) { return '' }\n    return `https://opensea.io/${wallet}`\n  }\n\n  function getSortIcon (currentColumn: string | null, currentDirection: 'asc' | 'desc' | null, columnKey: string) {\n    if (currentColumn === columnKey) {\n      return currentDirection === 'asc'\n        ? 'i-heroicons-bars-arrow-up-20-solid'\n        : 'i-heroicons-bars-arrow-down-20-solid'\n    }\n    return 'i-heroicons-arrows-up-down-20-solid'\n  }\n\n  function getNestedValue (obj: Record<string, unknown>, path: string): unknown {\n    return path.split('.').reduce<unknown>((current, key) => {\n      if (current && typeof current === 'object') {\n        return (current as Record<string, unknown>)[key]\n      }\n      return undefined\n    }, obj)\n  }\n\n  async function exportToCSV (\n    data: Record<string, unknown>[],\n    columnConfig: { key: string; label: string; formatter?: (value: unknown) => string }[],\n    filename?: string\n  ) {\n    if (data.length === 0) {\n      return\n    }\n\n    // Pre-process data with formatters and nested properties\n    const processedData = data.map((row) => {\n      const result: Record<string, unknown> = {}\n      columnConfig.forEach((col) => {\n        const value = getNestedValue(row, col.key)\n        result[col.label] = col.formatter ? col.formatter(value) : value\n      })\n      return result\n    })\n\n    // Use column labels as keys for the utility\n    const columns = columnConfig.map(col => ({ accessorKey: col.label, header: col.label }))\n    const finalFilename = filename || `export_${new Date().toISOString().split('T')[0]}.csv`\n\n    await downloadCSV(processedData, columns, finalFilename)\n  }\n\n  async function exportReadersToCSV () {\n    const dataToExport = hasSelection.value ? selectedRows.value : ordersStore.readers\n\n    const columnConfig: { key: string; label: string; formatter?: (value: unknown) => string }[] = [\n      { key: 'readerEmail', label: t('table.reader_email') },\n      { key: 'readerWallet', label: t('table.reader_wallet') },\n      { key: 'firstPurchaseTime', label: t('table.first_purchase'), formatter: (val: unknown) => formatDate(val as string | number) },\n      { key: 'lastPurchaseTime', label: t('table.last_purchase'), formatter: (val: unknown) => formatDate(val as string | number) },\n      { key: 'lifetimeValue', label: `${t('table.lifetime_value')} (USD)`, formatter: (val: unknown) => formatValue(val as number) },\n      { key: 'hasMessage', label: t('table.has_message'), formatter: (val: unknown) => (val as boolean) ? 'Y' : 'N' },\n      ...Object.values(ordersStore.booksInfo).map((book: BookInfo) => ({\n        key: `purchasedBooks.${book.classId}`,\n        label: book.name || book.classId,\n        formatter: (val: unknown) => (val as boolean) ? 'Y' : 'N'\n      }))\n    ]\n\n    const filename = `readers_export_${new Date().toISOString().split('T')[0]}.csv`\n    await exportToCSV(dataToExport as Record<string, unknown>[], columnConfig, filename)\n  }\n\n  return {\n    ordersStore,\n\n    sortedReaders,\n    paginatedReaders,\n    columns,\n    totalPages,\n\n    pagination: readonly(pagination),\n    sortState: readonly(sortState),\n    selectedRows,\n    hasSelection,\n    selectionCount,\n    baseColumnsConfig,\n\n    setSortState,\n    setPage,\n    setPageSize,\n    onSelect,\n    clearSelection,\n\n    formatDate,\n    formatCurrency: formatValue,\n    shortenWallet,\n    getWalletLink,\n\n    getSortIcon,\n    pageSizeOptions,\n\n    exportToCSV,\n    exportReadersToCSV\n  }\n}\n","<template>\n  <PageBody class=\"space-y-6\">\n    <div class=\"flex justify-between items-center\">\n      <h1 class=\"text-lg font-bold font-mono\" v-text=\"$t('menu.readers_list')\" />\n      <div class=\"flex gap-2\">\n        <UButton\n          icon=\"i-hugeicons-csv-02\"\n          color=\"primary\"\n          variant=\"outline\"\n          @click=\"exportSelectedToCSV\"\n        >\n          {{ $t('common.export_csv',{ length: hasSelection ? selectionCount : ordersStore.readers.length }) }}\n        </UButton>\n        <UButton\n          icon=\"i-heroicons-arrow-path\"\n          variant=\"outline\"\n          color=\"neutral\"\n          :disabled=\"ordersStore.isLoading\"\n          :loading=\"ordersStore.isLoading\"\n          @click=\"refreshData\"\n        />\n      </div>\n    </div>\n\n    <UAlert\n      v-if=\"ordersStore.error\"\n      icon=\"i-heroicons-exclamation-triangle\"\n      color=\"error\"\n      variant=\"soft\"\n      :title=\"ordersStore.error\"\n      :close=\"{ icon: 'i-heroicons-x-mark-20-solid', color: 'error', variant: 'link' }\"\n      @close=\"ordersStore.clearError()\"\n    />\n\n    <UCard :ui=\"{ body: 'p-0!' }\">\n      <template #header>\n        <div class=\"flex justify-between items-center\">\n          <h3 class=\"font-medium\" v-text=\"$t('readers.total_readers', { count: ordersStore.isLoading ? '...' : ordersStore.readers.length })\" />\n          <div class=\"flex items-center gap-2\">\n            <span class=\"text-sm text-gray-500\" v-text=\"$t('common.page_size')\" />\n            <USelect\n              v-model=\"pageSize\"\n              :items=\"pageSizeOptions\"\n              size=\"sm\"\n              @update:model-value=\"onPageSizeChange\"\n            />\n          </div>\n        </div>\n      </template>\n\n      <UTable\n        :model-value=\"selectedRows\"\n        :data=\"paginatedReaders\"\n        :columns=\"columns\"\n        :loading=\"ordersStore.isLoading\"\n        :progress=\"{ color: 'primary', animation: 'carousel' }\"\n        :ui=\"{\n          th: 'text-left text-nowrap whitespace-nowrap',\n          td: 'text-right',\n          tr: 'cursor-default [&>td]:pointer-events-none [&>td>*]:pointer-events-auto [&>td>input]:pointer-events-auto hover:bg-gray-50 dark:hover:bg-gray-800/30 transition-colors duration-200',\n        }\"\n        @update:model-value=\"onSelect\"\n      >\n        <!-- headers -->\n        <template\n          v-for=\"column in baseColumnsConfig\"\n          :key=\"`header-${column.key}`\"\n          #[`${column.key}-header`]\n        >\n          <UButton\n            v-if=\"column.key !== 'lifetimeValue'\"\n            color=\"neutral\"\n            variant=\"ghost\"\n            :label=\"column.label\"\n            :trailing-icon=\"getSortIcon(sortState.column, sortState.direction, column.key)\"\n            @click=\"() => sortByColumn(column.key)\"\n          />\n          <UTooltip v-else text=\"USD\">\n            <UButton\n              color=\"neutral\"\n              variant=\"ghost\"\n              :label=\"column.label\"\n              :trailing-icon=\"getSortIcon(sortState.column, sortState.direction, column.key)\"\n              @click=\"() => sortByColumn(column.key)\"\n            />\n          </UTooltip>\n        </template>\n        <template\n          v-for=\"book in Object.values(ordersStore.booksInfo)\"\n          :key=\"`header-${book.classId}`\"\n          #[`book_${book.classId}-header`]\n        >\n          <UTooltip :text=\"book.name || book.classId\" class=\"cursor-help\">\n            <UButton\n              color=\"neutral\"\n              variant=\"ghost\"\n              :label=\"book.name?.slice(0, 1) || book.classId.slice(0, 1)\"\n              :trailing-icon=\"getSortIcon(sortState.column, sortState.direction, `book_${book.classId}`)\"\n              @click=\"() => sortByColumn(`book_${book.classId}`)\"\n            />\n          </UTooltip>\n        </template>\n\n        <!-- rows -->\n        <template #readerEmail-cell=\"{ row }\">\n          <div class=\"w-full flex justify-start\">\n            <UButton\n              :label=\"row.original.readerEmail\"\n              variant=\"link\"\n              size=\"sm\"\n              @click.stop=\"openMailto(row.original.readerEmail)\"\n            />\n          </div>\n        </template>\n\n        <template #readerWallet-cell=\"{ row }\">\n          <UButton\n            v-if=\"row.original.readerWallet\"\n            class=\"font-mono\"\n            :label=\"shortenWallet(row.original.readerWallet)\"\n            variant=\"link\"\n            size=\"sm\"\n            @click.stop=\"openWalletLink(row.original.readerWallet)\"\n          />\n          <span v-else class=\"text-gray-400\">-</span>\n        </template>\n\n        <template #firstPurchaseTime-cell=\"{ row }\">\n          <span class=\"text-sm\" v-text=\"formatDate(row.original.firstPurchaseTime)\" />\n        </template>\n\n        <template #lastPurchaseTime-cell=\"{ row }\">\n          <span class=\"text-sm\" v-text=\"formatDate(row.original.lastPurchaseTime)\" />\n        </template>\n\n        <template #lifetimeValue-cell=\"{ row }\">\n          <span class=\"font-medium\" v-text=\"`$${formatValue(row.original.lifetimeValue)}`\" />\n        </template>\n\n        <template #hasMessage-cell=\"{ row }\">\n          <div class=\"flex justify-center w-full\">\n            <UBadge\n              :color=\"row.original.hasMessage ? 'success' : 'neutral'\"\n              :label=\"row.original.hasMessage ? 'Y' : 'N'\"\n              variant=\"soft\"\n            />\n          </div>\n        </template>\n        <template\n          v-for=\"book in Object.values(ordersStore.booksInfo)\"\n          :key=\"`template-${book.classId}`\"\n          #[`book_${book.classId}-cell`]=\"{ row }\"\n        >\n          <div class=\"flex justify-center w-full\">\n            <UBadge\n              :color=\"(row.original as Record<string, unknown>)[`book_${book.classId}`] ? 'success' : 'neutral'\"\n              :label=\"(row.original as Record<string, unknown>)[`book_${book.classId}`] ? 'Y' : 'N'\"\n              variant=\"soft\"\n            />\n          </div>\n        </template>\n      </UTable>\n\n      <template #footer>\n        <div class=\"flex justify-end items-center\">\n          <UPagination\n            v-model:page=\"currentPage\"\n            :page-count=\"pagination.limit\"\n            :total=\"ordersStore.readers.length\"\n            :max=\"7\"\n            show-last\n            show-first\n          />\n        </div>\n      </template>\n    </UCard>\n  </PageBody>\n</template>\n\n<script setup lang=\"ts\">\nconst { t: $t } = useI18n()\n\nconst bookstoreApiStore = useBookstoreApiStore()\n\nconst {\n  ordersStore,\n  paginatedReaders,\n  columns,\n  pagination,\n  sortState,\n  selectedRows,\n  hasSelection,\n  selectionCount,\n  setSortState,\n  setPage,\n  setPageSize,\n  onSelect,\n  clearSelection,\n  formatDate,\n  formatCurrency: formatValue,\n  shortenWallet,\n  getWalletLink,\n  getSortIcon,\n  baseColumnsConfig,\n  pageSizeOptions,\n  exportReadersToCSV\n} = useReadersTable()\n\nconst pageSize = ref(100)\nconst currentPage = ref(1)\n\nwatch(currentPage, (newPage: number) => {\n  setPage(newPage)\n})\n\nonMounted(async () => {\n  if (bookstoreApiStore.isAuthenticated) {\n    await loadReadersData()\n  }\n})\n\nasync function loadReadersData () {\n  await ordersStore.fetchReaders()\n}\n\nasync function refreshData () {\n  await ordersStore.fetchReaders(true)\n  clearSelection()\n}\n\nfunction onPageSizeChange (newSize: number) {\n  setPageSize(newSize)\n  currentPage.value = 1\n}\n\nfunction sortByColumn (columnKey: string) {\n  const currentSort = sortState.value\n\n  if (currentSort.column === columnKey) {\n    if (currentSort.direction === 'asc') {\n      setSortState(columnKey, 'desc')\n    } else if (currentSort.direction === 'desc') {\n      setSortState(null, null)\n    } else {\n      setSortState(columnKey, 'asc')\n    }\n  } else {\n    setSortState(columnKey, 'asc')\n  }\n}\n\nfunction exportSelectedToCSV () {\n  exportReadersToCSV()\n}\n\nfunction openMailto (email: string) {\n  window.open(`mailto:${email}`, '_self')\n}\n\nfunction openWalletLink (wallet: string) {\n  window.open(getWalletLink(wallet), '_blank')\n}\n</script>\n"],"names":["useReadersTable","t","useI18n","ordersStore","useOrdersStore","pagination","ref","sortState","pageSizeOptions","selectedRows","hasSelection","computed","selectionCount","baseColumnsConfig","columns","baseColumns","col","bookColumns","book","sortedReaders","readers","a","b","aValue","bValue","comparison","aTime","bTime","paginatedReaders","start","end","totalPages","onSelect","rows","clearSelection","formatDate","dateString","locale","date","formatValue","amount","decimals","setSortState","column","direction","setPage","page","maxPage","setPageSize","limit","shortenWallet","wallet","startLength","endLength","getWalletLink","getSortIcon","currentColumn","currentDirection","columnKey","getNestedValue","obj","path","current","key","exportToCSV","data","columnConfig","filename","processedData","row","result","value","finalFilename","downloadCSV","exportReadersToCSV","dataToExport","val","readonly","$t","bookstoreApiStore","useBookstoreApiStore","pageSize","currentPage","watch","newPage","onMounted","loadReadersData","refreshData","onPageSizeChange","newSize","sortByColumn","currentSort","exportSelectedToCSV","openMailto","email","openWalletLink","_createBlock","_component_PageBody","_createElementVNode","_hoisted_1","_toDisplayString","_unref","_hoisted_3","_createVNode","_component_UButton","_component_UAlert","_cache","$event","_component_UCard","_hoisted_4","_hoisted_6","_component_USelect","_hoisted_15","_component_UPagination","_component_UTable","_withCtx","_hoisted_8","_createElementBlock","_hoisted_9","_hoisted_13","_component_UBadge","_renderList","_component_UTooltip","_hoisted_14"],"mappings":"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"}