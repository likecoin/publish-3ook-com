import{g as Me,Q as We,A as je,u as Et,s as ce,b as ze,w as be,C as M,m as y,l as F,L as m,q as t,ao as qe,e as c,$ as W,p as l,n as s,N as ge,M as g,a1 as He,c as _,D as At,a as Rt,B as Pt,R as Ot,U as Bt,o as Vt,W as N,X as Kt,aa as Ae,Y as Mt,ai as Re,aO as Wt,a8 as jt,a3 as zt,aq as qt,a7 as Ht,a0 as Qt,ab as Xt,ac as Yt,bv as Gt,S as Pe,ae as Jt,af as Oe,bu as Zt,bw as Be}from"./9S2XGRg9.js";import{_ as ea}from"./DlXEXVN8.js";import{u as Qe,a as ta}from"./CSf5BCM0.js";import{u as Xe}from"./DJApvAF_.js";import{a as aa,u as oa}from"./CFNaZjOu.js";import{u as na,f as la,v as sa}from"./2HupUEEh.js";import{_ as ia}from"./drKZnbC8.js";import{_ as ra}from"./BAMg4a5m.js";import{_ as ca}from"./D3om2a5D.js";import{_ as ua}from"./Bu69eulW.js";import{_ as da}from"./CL7xOAbk.js";import{_ as ma}from"./4vuI4WC3.js";import{_ as fa}from"./CLuOJMie.js";import{g as pa}from"./BFNvVrx5.js";import{u as _a}from"./DOPoUBoe.js";import{u as ha}from"./RNJfQWMs.js";import"./D2HD6JMx.js";import"./D89E3aNf.js";import"./DvvTWQeW.js";import"./BxkXgiy8.js";import"./dJIpU6wD.js";import"./Do2UJywV.js";(function(){try{var w=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};w.SENTRY_RELEASE={id:"cd189bad150b481aa5ecb2e95de26ec677010e55"}}catch{}})();try{(function(){var w=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new w.Error().stack;n&&(w._sentryDebugIds=w._sentryDebugIds||{},w._sentryDebugIds[n]="3fb65e37-b2df-4cbe-b116-90a92e051a0b",w._sentryDebugIdIdentifier="sentry-dbid-3fb65e37-b2df-4cbe-b116-90a92e051a0b")})()}catch{}const va={class:"my-4"},ba={class:"w-full flex justify-center items-center gap-2 my-4"},ga=Me({__name:"EditISCNMetadataForm",props:{classId:{}},emits:["iscnUpdated"],setup(w,{emit:n}){const{t:H}=We(),ue=n,j=Xe(),B=je(),X=Et(),{wallet:Y,signer:Z}=ce(X),{validateWalletConsistency:Q}=X,{writeContractAsync:L}=aa(),{checkAndGrantUpdater:de,assertSufficientBalanceForTransaction:ee,waitForTransactionReceipt:me}=oa(),{getNFTClassConfig:fe}=Qe(),{refreshBookMetadata:te}=ze(),E=w,ae=c({}),A=c(!1),R=c(!1),oe=c(null),P=c({type:"Book",title:"",description:"",descriptionFull:"",alternativeHeadline:"",isbn:"",publisher:"",publicationDate:"",author:{name:"",description:""},license:"All rights reserved",contentFingerprints:[{url:""}],downloadableUrls:[{url:"",type:"",fileName:""}],customLicense:"",language:"",bookInfoUrl:"",tags:[],coverUrl:"",genre:""}),$=c({}),{payload:U,getFileTypeFromMime:f}=na({iscnFormData:P,iscnChainData:$}),z=_(()=>sa(P.value)),V=_(()=>!z.value?.length);be(()=>E.classId,async v=>{if(v)try{R.value=!0;const b=await j.lazyFetchClassMetadataById(v);if(!b)return;ae.value=b;const i=ae.value;let k=[{url:"",type:"",fileName:""}];i.potentialAction?.target&&Array.isArray(i.potentialAction.target)?k=i.potentialAction.target.map(p=>({type:f(p.contentType),url:p.url||"",fileName:p.name||""})):i.sameAs&&Array.isArray(i.sameAs)&&(k=i.sameAs.map(S));const C=[];i.keywords&&(Array.isArray(i.keywords)?C.push(...i.keywords):C.push(...i.keywords.split(",").map(p=>p.trim()).filter(p=>p))),$.value=i,P.value={...i,type:i["@type"]||"Book",title:i.name||"",description:i.description||"",descriptionFull:i.descriptionFull||"",alternativeHeadline:i.alternativeHeadline||"",isbn:i.isbn||"",publisher:i.publisher||"",publicationDate:i.datePublished||"",author:{name:(typeof i.author=="object"?i.author?.name:i.author)||"",description:(typeof i.author=="object"?i.author?.description:"")||""},license:i.usageInfo||"All Rights Reserved",contentFingerprints:i.contentFingerprints?.map(p=>({url:p}))||[{url:""}],downloadableUrls:k,customLicense:"",language:i.inLanguage||"",bookInfoUrl:i.url||"",tags:C,coverUrl:i.thumbnailUrl||i.image||"",genre:i.genre||""}}catch(b){console.error("Error fetching ISCN data:",b)}finally{R.value=!1}},{immediate:!0});function S(v){try{const i=new URL(v).searchParams.get("name")||"",[k="",C]=i.split(".");return{url:v.split("?")[0]||"",fileName:k,type:C||""}}catch{return{url:v,fileName:"",type:""}}}async function h(){if(await Q(),!Y.value||!Z.value){B.add({title:H("auth.login_required"),color:"error"});return}if(!V.value){B.add({title:z.value.join(", "),color:"error"});return}A.value=!0;try{const v=la(U.value),b={...v,symbol:"BOOK",external_link:v?.url||"",image:v?.thumbnailUrl||"",nft_meta_collection_id:"nft_book",nft_meta_collection_name:"NFT Book",nft_meta_collection_description:"NFT Book by Liker Land",recordTimestamp:new Date().toISOString()},i=await fe(E.classId);await de({classId:E.classId,wallet:Y.value});const k={address:E.classId,abi:ta,functionName:"update",args:[{name:b.name,symbol:i.symbol,metadata:JSON.stringify(b),max_supply:At}]};await ee({wallet:Y.value,...k});const C=await L(k),p=await me({hash:C});if(!p||p.status!=="success")throw new Error("INVALID_RECEIPT");B.add({title:H("edit_iscn.update_success"),color:"info"}),oe.value?.resetSnapshot(),await j.fetchClassMetadataById(E.classId),await te(E.classId),ue("iscnUpdated",{classId:E.classId,metadata:b})}catch(v){B.add({title:H("edit_iscn.update_failed"),description:v.message,color:"error"})}finally{A.value=!1}}return(v,b)=>{const i=qe,k=ea,C=He;return y(),M("div",va,[t(R)?(y(),F(i,{key:0,animation:"carousel",color:"primary",class:"w-full"})):(y(),F(k,{key:1,ref_key:"iscnFormRef",ref:oe,modelValue:t(P),"onUpdate:modelValue":b[0]||(b[0]=p=>W(P)?P.value=p:null)},null,8,["modelValue"])),m("div",ba,[l(C,{color:"primary",loading:t(A),onClick:h},{default:s(()=>[ge(g(t(H)("common.save")),1)]),_:1},8,["loading"])])])}}}),ya=Object.assign(ga,{__name:"EditISCNMetadataForm"});function Ve(w){return w?`${w.slice(0,10)}...${w.slice(-6)}`:"-"}const ka={class:"flex justify-between items-center w-full"},wa={class:"flex items-center gap-2"},Ca=["textContent"],xa={class:"flex justify-between items-center"},Sa=["textContent"],Ia={class:"flex justify-between items-center gap-4"},Ta={key:0,class:"flex flex-col gap-1"},Na=["textContent"],$a=["textContent"],Ua=["textContent"],Da={class:"text-right"},Fa={class:"text-right"},La={class:"flex justify-end items-center"},Ea=["textContent"],Aa={class:"flex justify-between items-center w-full"},Ra=["textContent"],Pa={class:"mt-[24px] flex flex-col gap-[12px]"},Oa=["textContent"],Ba={key:0,class:"font-bold font-mono"},Va=["textContent"],Ka={class:"flex gap-2"},Ma={class:"flex justify-end items-center"},Wa=["textContent"],ja=["textContent"],za={class:"flex items-center gap-2"},qa={key:1,class:"flex items-center gap-2"},Ha={class:"flex items-center justify-center w-full mt-4"},Qa=["textContent"],Ke=2,Xa=1,go=Me({__name:"[classId]",setup(w){const{t:n}=We(),{CHAIN_EXPLORER_URL:H,BOOK3_URL:ue,LIKE_CO_API:j}=Rt().public,B=ze(),X=Xe(),Y=_a(),Z=ha(),{token:Q,wallet:L}=ce(B),{ordersByClassIdMap:de}=ce(Z),{updateBookListingSetting:ee,reduceListingPendingNFTCountById:me}=B,{lazyFetchClassMetadataById:fe}=X,{fetchStripeConnectStatusByWallet:te}=Y,{getBalanceOf:E}=Qe(),ae=Pt(),A=Ot(),R=je(),oe=Bt(),{userLikerInfo:P}=ce(oe),$=c(""),U=c(!1),f=c(ae.params.classId),z=c(""),V=c(0),S=c({}),h=c([]),v=c(!1),b=c(!1),i=c(!1),k=c(""),C=c(""),p=c([]),D=c(""),Ye=c(""),ye=c(!1),ke=c(""),we=c({}),Ce=c(!0),ne=c(!1),xe=c(!0),Ge=c(!0),Je=c(!1),Ze=c(!0),le=c(-99),G=c(!1),Se=_(()=>X.getClassMetadataById(f.value)?.name),Ie=_(()=>{const e=`${ue}/store/${f.value}`;return P.value?.user?`${e}?from=@${P.value.user}`:e}),Te=_(()=>S?.value?.ownerWallet),pe=_(()=>L.value&&Te.value===L.value),et=_(()=>pe.value),I=_(()=>z.value.split(",").filter((e,a)=>!!e||a===0).map(e=>e.trim()).map(e=>({channel:e,url:Zt({classId:f.value,priceIndex:V.value,channel:e,isUseLikerLandLink:Ge.value})}))),q=c(void 0),se=_({get:()=>!!q.value,set:e=>{e||(q.value=void 0)}}),tt=_(()=>_e.value.length?_e.value.reduce((a,r)=>{const u=r.from||"empty";return a[u]||(a[u]={count:0,totalUSD:0}),a[u].count+=1,a[u].totalUSD+=r.price,a},{}):{}),_e=_(()=>ie.value?.length?ie.value.map(e=>{const a=e.timestamp,r=new Date(a),u=`${r.getDate()}/${r.getMonth()+1}/${r.getFullYear()}`;return{...e,formattedDate:u}}).sort((e,a)=>a.timestamp-e.timestamp):[]),at=_(()=>[{accessorKey:"actions",header:n("table.actions")},{accessorKey:"orderDate",header:n("table.order_date")},{accessorKey:"status",header:n("table.status")},{accessorKey:"from",header:n("table.sales_channel")},{accessorKey:"price",header:n("form.price"),class:"w-[120px]"},{accessorKey:"priceName",header:n("table.price_name")},{accessorKey:"quantity",header:n("table.quantity")},{accessorKey:"coupon",header:n("table.coupon_applied")},{accessorKey:"buyerEmail",header:n("table.buyer_email")},{accessorKey:"readerEmail",header:n("table.reader_email")},{accessorKey:"wallet",header:n("table.reader_wallet")},{accessorKey:"message",header:n("table.reader_message")}]),ie=_(()=>de.value.get(f.value)||[]);function ot(e=""){const a=[`${Se.value||f.value}`,`price_${V.value}`];return e&&a.push(`channel_${e}`),a.join("_")}function nt(e){const a=[];return e.status==="completed"&&e.txHash?a.push([{label:n("status_page.view_transaction"),icon:"i-heroicons-magnifying-glass",to:`${H}/${e.txHash}`,target:"_blank"}]):e.status==="pendingNFT"&&et.value&&a.push([{label:"Send NFT",icon:"i-heroicons-paper-airplane",to:A({name:"my-books-send-classId",params:{classId:e.classId},query:{owner_wallet:Te.value,payment_id:e.id}})}]),e.status==="paid"&&a.push([{label:n("status_page.send_reminder_email"),icon:"i-heroicons-envelope",click:()=>{vt(e)}}]),["pendingNFT","paid"].includes(e.status)&&a.push([{label:n("status_page.mark_complete"),icon:"i-heroicons-check-circle",click:()=>{bt(e)}}]),a}function lt(e){switch(e.status){case"paid":return"Paid";case"pendingNFT":return n("status.pendingNFT");case"completed":return n("status.completed");default:return e.status}}function st(e){switch(e.status){case"paid":return"info";case"pendingNFT":return"warning";case"completed":return"success";default:return"neutral"}}const it=_(()=>_e.value?.map((e,a)=>({index:a,readerEmail:e.giftInfo?.toEmail||e.email,buyerEmail:e.email,buyerPhone:e.phone||"",status:e.status,statusLabel:lt(e),statusLabelColor:st(e),orderDate:e.formattedDate,wallet:e.wallet||"",walletLink:Be(e.wallet),shortenWallet:Ve(e.wallet),priceName:e.priceName,price:e.price||0,coupon:e.coupon||"",message:e.message||"",from:e.from||"",quantity:e.quantity||1,actions:nt(e)})).filter(e=>{if(!k.value)return!0;const a=k.value.toLowerCase();return e.readerEmail.toLowerCase().includes(a)||e.buyerEmail.toLowerCase().includes(a)||e.buyerPhone.toLowerCase().includes(a)||e.wallet?.toLowerCase().includes(a)||e.priceName?.toLowerCase().includes(a)||e.statusLabel?.toLowerCase().includes(a)||e.orderDate?.toLowerCase().includes(a)||e.from?.toLowerCase().includes(a)})),rt=_(()=>{const e=[{accessorKey:"wallet",header:n("table.wallet")}];return pe.value&&e.push({accessorKey:"remove",header:""}),e}),ct=_(()=>p.value.map((e,a)=>({index:a,wallet:e,shortenWallet:Ve(e),walletLink:Be(e)})));function ut(e){switch(e){case"empty":return"Not set";default:return e}}const dt=_(()=>Object.entries(tt.value)?.map(([e,a])=>({id:e,idLabel:ut(e),count:a.count||0,totalUSD:(a.totalUSD||0).toFixed(2)}))),mt=_(()=>S.value.prices?.map((e,a)=>({label:`${typeof e.name=="object"?e.name.en||"":e.name} - $${e.price}`,value:a,disabled:a===V.value}))||[]),ft=_(()=>{const e=[];return e.push({accessorKey:"sort",header:n("table.sort"),class:"w-[60px]"},{accessorKey:"name",header:n("table.name")},{accessorKey:"delivery",header:n("table.delivery"),class:"w-[120px]"},{accessorKey:"stock",header:n("table.stock"),class:"w-[120px]"},{accessorKey:"price",header:n("table.price_usd"),class:"w-[120px]"}),pe.value&&e.push({accessorKey:"details",header:n("table.details"),class:"w-[80px]"}),e}),pt=_(()=>{const e=h.value.map((a,r)=>({...a,originalIndex:r,isStockBalancePlaceholderRow:!1}));return h.value.some(a=>!a.isAutoDeliver)&&e.push({name:"",isAutoDeliver:!1,stock:n("table.stock_balance",{count:le.value}),price:"",isStockBalancePlaceholderRow:!0,originalIndex:-1,index:-1,description:"",isAllowCustomPrice:!1}),e});be(U,e=>{e&&($.value="")}),be(L,async e=>{e?await he():le.value=-99}),Vt(async()=>{U.value=!0;try{const e=await $fetch(`${j}/likernft/book/store/${f.value}`,{headers:{authorization:`Bearer ${Q.value}`}});S.value=e,h.value=S.value.prices;const{moderatorWallets:a,connectedWallets:r,mustClaimToView:u,tableOfContents:T,enableCustomMessagePage:O,hideDownload:d}=e;p.value=a||[],ye.value=!!(r&&Object.keys(r).length),we.value=r||{};const K=r&&Object.keys(r)[0];if(K&&(ke.value=K,K!==L.value)){Ze.value=!1;try{await te(K)}catch(x){console.error(x)}}if(Ce.value=u??!0,ne.value=d??!1,xe.value=O??!0,C.value=T??"",await Z.fetchOrdersByClassId([f.value]),L.value){await he();try{await te(L.value)}catch(x){console.error(x)}}fe(f.value)}catch(e){$.value=e.toString()}finally{U.value=!1}});async function he(){const e=S.value.pendingNFTCount||0,a=await E(f.value,L.value),r=h.value.filter(u=>!u.isAutoDeliver).reduce((u,T)=>u+(T.stock||0),0);le.value=Number(a)-r-Xa-e||0}async function _t(e){e<=0||await Ne(e,e-1)}async function ht(e){e>=h.value.length-1||await Ne(e,e+1)}async function Ne(e,a){try{v.value=!0;const r=[...h.value],[u]=r.splice(e,1);if(!u)return;r.splice(a,0,u);const T=h.value[e];if(!T)return;const O=T.index;await $fetch(`${j}/likernft/book/store/${f.value}/price/${O}/order`,{method:"PUT",headers:{authorization:`Bearer ${Q.value}`},body:{order:a}}),h.value=r.map((d,K)=>({...d,order:K})),S.value.prices=h.value,R.add({icon:"i-heroicons-check-circle",title:"Updated editions order successfully",duration:2e3,color:"success"})}catch(r){h.value=S.value.prices,$.value=r.toString()}finally{v.value=!1}}async function vt(e){if(!ie.value?.find(r=>r.id===e.id))throw new Error("ORDER_NOT_FOUND");await $fetch(`${j}/likernft/book/purchase/${f.value}/status/${e.id}/remind`,{method:"POST",headers:{authorization:`Bearer ${Q.value}`}}),R.add({icon:"i-heroicons-check-circle",title:n("status_page.send_reminder_email"),duration:2e3,color:"success"})}async function bt(e){if(!confirm("Do you want to skip the 'Send NFT' action and override this payment status to 'completed'?"))return;const r=ie.value?.find(O=>O.id===e.id);if(!r)throw new Error("ORDER_NOT_FOUND");const u=r,T=u.status;u.status="completed";try{await $fetch(`${j}/likernft/book/purchase/${f.value}/sent/${e.id}`,{method:"POST",body:{txHash:null,quantity:e.quantity||1},headers:{authorization:`Bearer ${Q.value}`}})}catch(O){throw u.status=T,O}T==="pendingNFT"&&(S.value.pendingNFTCount=(S.value.pendingNFTCount||0)-1,me(f.value,1))}function gt(){D.value&&(p.value.push(D.value),D.value="")}async function yt(){try{if(D.value)throw new Error(n("errors.add_moderator_wallet"));if(Ye.value)throw new Error(n("errors.add_notification_email"));U.value=!0;const e=ye.value&&ke.value?we.value:null;await ee(f.value,{moderatorWallets:p.value,connectedWallets:e,hideDownload:ne.value,mustClaimToView:Ce.value,tableOfContents:C.value,enableCustomMessagePage:xe.value}),await Pe(A({name:"my-books"}))}catch(e){const a=e.data||e;console.error(a),$.value=String(a)}finally{U.value=!1,Je.value=!1}}async function $e(e=""){await navigator.clipboard.writeText(e),R.add({icon:"i-heroicons-check-circle",title:n("purchase_link.copied_to_clipboard"),duration:2e3,color:"success"})}function kt(){Jt({data:I.value,fileName:`${f.value}_purchase_links.csv`,fileType:"csv"})}function wt(){try{sessionStorage.setItem("nft_book_press_batch_qrcode",Oe(I.value.map(({channel:e,...a})=>({key:e,...a})))),window.open("/batch-qrcode?print=1","batch_qrcode","popup,menubar=no,location=no,status=no")}catch(e){console.error(e),R.add({icon:"i-heroicons-exclamation-circle",title:n("purchase_link.failed_print_qr"),duration:0,color:"error"})}}async function Ct(){try{sessionStorage.setItem("nft_book_press_batch_shorten_url",Oe(I.value.map(({channel:e,url:a})=>({key:e,url:a})))),await Pe(A({name:"batch-short-links",query:{print:1}}))}catch(e){console.error(e),R.add({icon:"i-heroicons-exclamation-circle",title:n("purchase_link.failed_shorten_links"),duration:0,color:"error"})}}function xt(){G.value=!0}async function St(){await he(),G.value=!1}function It(e){const r=pa().API_GET_ARWEAVE_V2_LINK;return e.some(u=>!!u.startsWith(r)||u.includes("?key="))}async function Tt({classId:e,metadata:a}){const{contentFingerprints:r}=a;if(r){const u=It(r);u!==ne.value&&(ne.value=u),await ee(e,{hideDownload:u})}}return(e,a)=>{const r=Kt,u=qe,T=jt,O=Wt,d=He,K=ya,x=Mt,J=ia,re=Qt,Ue=Ht,De=qt,Fe=ra,Nt=ca,ve=Xt,$t=ua,Ut=da,Le=Yt,Dt=ma,Ft=Gt,Lt=fa;return y(),F(Lt,{class:"space-y-10 pb-10"},{default:s(()=>[t($)?(y(),F(r,{key:0,icon:"i-heroicons-exclamation-triangle",color:"error",variant:"soft",title:`${t($)}`,close:{icon:"i-heroicons-x-mark-20-solid",color:"error",variant:"link"},onClose:a[0]||(a[0]=o=>$.value="")},null,8,["title"])):N("",!0),t(U)?(y(),F(u,{key:1,animation:"carousel"},{indicator:s(()=>[ge(g(t(n)("loading.progress")),1)]),_:1})):N("",!0),t(B).isAuthenticated?(y(),M(Ae,{key:2},[l(x,{class:Re(t(i)?"ring-2 ring-gray-500":"ring-1 ring-gray-200"),ui:{header:"flex justify-between items-center",body:"p-3"}},{default:s(()=>[m("div",ka,[m("div",wa,[m("h3",{class:"font-bold font-mono",textContent:g(t(Se)||t(f))},null,8,Ca),l(O,{to:t(Ie),class:"flex items-center",target:"_blank"},{default:s(()=>[l(T,{name:"i-heroicons-arrow-top-right-on-square",size:"xl"})]),_:1},8,["to"]),l(d,{icon:"i-heroicons-document-duplicate",variant:"ghost",color:"neutral",size:"xs",onClick:a[1]||(a[1]=o=>t(zt)(t(Ie)))})]),l(d,{color:"neutral",variant:"ghost",trailing:"",label:t(n)("form.edit_iscn_metadata"),icon:t(i)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:a[2]||(a[2]=()=>{i.value=!t(i)})},null,8,["label","icon"])]),t(i)?(y(),F(K,{key:0,"class-id":t(f),onIscnUpdated:Tt},null,8,["class-id"])):N("",!0)]),_:1},8,["class"]),l(x,{ui:{body:"p-0"}},{header:s(()=>[m("div",xa,[m("h3",{class:"font-bold font-mono",textContent:g(t(n)("pages.editions"))},null,8,Sa),m("div",Ia,[l(d,{icon:"i-heroicons-plus",class:"mb-[12px]",variant:"outline",color:t(h).length>=Ke?"neutral":"primary",disabled:t(h).length>=Ke,label:t(n)("form.add_edition"),to:t(A)({name:"my-books-status-classId-edit-new",params:{classId:t(f)},query:{price_index:t(h).length}})},null,8,["color","disabled","label","to"])])])]),footer:s(()=>[m("div",La,[l(d,{icon:"i-heroicons-plus",label:t(n)("buttons.mint_new_stock"),onClick:xt},null,8,["label"])])]),default:s(()=>[l(J,{columns:t(ft),data:t(pt)},{"sort-cell":s(({row:o})=>[!o.original.isStockBalancePlaceholderRow&&t(h).length>1?(y(),M("div",Ta,[l(d,{icon:o.original.originalIndex===0?"i-heroicons-chevron-down":"i-heroicons-chevron-up",variant:"ghost",color:"neutral",size:"xs",label:String(o.original.originalIndex+1),disabled:t(v)||o.original.originalIndex<=0&&o.original.originalIndex>=t(h).length-1,loading:t(v),trailing:"",onClick:Ee=>o.original.originalIndex===0?ht(o.original.originalIndex):_t(o.original.originalIndex)},null,8,["icon","label","disabled","loading","onClick"])])):N("",!0),!o.original.isStockBalancePlaceholderRow&&t(h).length===1?(y(),M("span",{key:1,textContent:g(String(o.original.originalIndex+1))},null,8,Na)):N("",!0)]),"name-cell":s(({row:o})=>[m("h4",{class:"font-medium",textContent:g(typeof o.original.name=="object"?o.original.name.zh:o.original.name)},null,8,$a)]),"delivery-cell":s(({row:o})=>[o.original.isStockBalancePlaceholderRow?N("",!0):(y(),M("h4",{key:0,class:"font-medium",textContent:g(o.original.isAutoDeliver?t(n)("form.auto_delivery"):t(n)("form.manual_delivery"))},null,8,Ua))]),"stock-cell":s(({row:o})=>[m("span",Da,g(o.original.isAutoDeliver?t(n)("form.auto_stock"):o.original.stock),1)]),"price-cell":s(({row:o})=>[m("span",Fa,g(o.original.price),1)]),"details-cell":s(({row:o})=>[o.original.isStockBalancePlaceholderRow?N("",!0):(y(),F(d,{key:0,icon:"i-heroicons-document",to:t(A)({name:"my-books-status-classId-edit-editionIndex",params:{classId:t(f),editionIndex:String(o.original.index)}}),variant:"soft",color:"neutral"},null,8,["to"]))]),_:1},8,["columns","data"])]),_:1}),l(x,{ui:{header:"flex justify-between items-center gap-4",body:"p-0"}},{header:s(()=>[m("h3",{class:"font-bold font-mono",textContent:g(t(n)("pages.orders"))},null,8,Ea),l(re,{modelValue:t(k),"onUpdate:modelValue":a[3]||(a[3]=o=>W(k)?k.value=o:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:t(n)("status_page.search_placeholder")},null,8,["modelValue","placeholder"])]),default:s(()=>[l(J,{ui:{th:"whitespace-nowrap"},columns:t(at),data:t(it)},{"buyerEmail-cell":s(({row:o})=>[l(d,{label:o.original.buyerEmail,to:`mailto:${o.original.buyerEmail}`,variant:"link"},null,8,["label","to"])]),"readerEmail-cell":s(({row:o})=>[l(d,{label:o.original.readerEmail,to:`mailto:${o.original.readerEmail}`,variant:"link"},null,8,["label","to"])]),"wallet-cell":s(({row:o})=>[l(Ue,{text:o.original.wallet},{default:s(()=>[l(d,{class:"font-mono",label:o.original.shortenWallet,to:o.original.walletLink,variant:"link",size:"xs",target:"_blank"},null,8,["label","to"])]),_:2},1032,["text"])]),"status-cell":s(({row:o})=>[l(De,{color:o.original.statusLabelColor,label:o.original.statusLabel,variant:"outline",class:"rounded-full"},null,8,["color","label"])]),"actions-cell":s(({row:o})=>[l(Fe,{items:o.original.actions},{default:s(()=>[l(d,{class:Re({hidden:!o.original.actions.length}),icon:"i-heroicons-ellipsis-horizontal-20-solid",color:"neutral",variant:"ghost"},null,8,["class"])]),_:2},1032,["items"])]),_:1},8,["columns","data"])]),_:1}),l(x,{ui:{header:"flex justify-between items-center",body:"p-3"}},{default:s(()=>[m("div",Aa,[m("h3",{class:"font-bold font-mono",textContent:g(t(n)("nft_book_form.advanced_settings"))},null,8,Ra),l(d,{color:"neutral",variant:"ghost",icon:t(b)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:a[4]||(a[4]=()=>{b.value=!t(b)})},null,8,["icon"])]),t(b)?(y(),M(Ae,{key:0},[m("div",Pa,[l(x,{ui:{body:"p-0"}},{header:s(()=>[m("h3",{class:"font-bold font-mono",textContent:g(t(n)("pages.sales_channel_summary"))},null,8,Oa)]),default:s(()=>[l(J,{columns:[{accessorKey:"id",header:t(n)("table.channel_id")},{accessorKey:"count",header:t(n)("table.count")},{accessorKey:"totalUSD",header:t(n)("table.total_usd")}],data:t(dt)},{"id-cell":s(({row:o})=>[o.original.id!=="empty"?(y(),M("span",Ba,g(o.original.idLabel),1)):(y(),F(De,{key:1,label:o.original.idLabel,class:"rounded-full",color:"neutral"},null,8,["label"]))]),_:1},8,["columns","data"])]),_:1}),l(x,{ui:{header:"flex justify-between items-center",body:"space-y-8 p-0"}},{header:s(()=>[m("h4",{class:"text-sm font-bold font-mono",textContent:g(t(n)("form.share_sales_data"))},null,8,Va),m("div",Ka,[l(re,{modelValue:t(D),"onUpdate:modelValue":a[5]||(a[5]=o=>W(D)?D.value=o:null),class:"font-mono",placeholder:"0x..."},null,8,["modelValue"]),l(d,{label:t(n)("common.add"),variant:t(D)?"outline":"solid",color:t(D)?"primary":"neutral",disabled:!t(D),onClick:gt},null,8,["label","variant","color","disabled"])])]),default:s(()=>[l(J,{columns:t(rt),data:t(ct)},{"wallet-cell":s(({row:o})=>[l(Ue,{text:o.original.wallet},{default:s(()=>[l(d,{class:"font-mono",label:o.original.shortenWallet,to:o.original.walletLink,variant:"link",size:"xs"},null,8,["label","to"])]),_:2},1032,["text"])]),"remove-cell":s(({row:o})=>[m("div",Ma,[l(d,{icon:"i-heroicons-x-mark",variant:"soft",color:"error",onClick:()=>{t(p).splice(o.original.index,1)}},null,8,["onClick"])])]),_:1},8,["columns","data"])]),_:1}),l(x,{ui:{body:"space-y-4"}},{header:s(()=>[m("h3",{class:"font-bold font-mono",textContent:g(t(n)("form.copy_purchase_link"))},null,8,Wa)]),default:s(()=>[l(ve,{label:t(n)("form.edition")},{default:s(()=>[l(Nt,{modelValue:t(V),"onUpdate:modelValue":a[6]||(a[6]=o=>W(V)?V.value=o:null),items:t(mt)},null,8,["modelValue","items"])]),_:1},8,["label"]),l(ve,{label:t(n)("form.sales_channel_for_links")},{default:s(()=>[l(re,{modelValue:t(z),"onUpdate:modelValue":a[7]||(a[7]=o=>W(z)?z.value=o:null),placeholder:"Channel ID(s), separated by commas (e.g. store01, store02)"},null,8,["modelValue"])]),_:1},8,["label"]),t(I).length>1?(y(),F(x,{key:0,ui:{header:"flex justify-between items-center",body:"p-0"}},{header:s(()=>[m("h4",{class:"text-sm font-bold font-mono",textContent:g(t(n)("purchase_link.download_all_links"))},null,8,ja),l(Fe,{items:[[{label:t(n)("buttons.print_all_qr"),icon:"i-heroicons-qr-code",click:wt},{label:t(n)("buttons.download_all_links"),icon:"i-heroicons-arrow-down-on-square-stack",click:kt},{label:t(n)("buttons.shorten_all_links"),icon:"i-heroicons-sparkles",click:Ct}]],popper:{placement:"top-end"}},{default:s(()=>[l(d,{icon:"i-heroicons-ellipsis-horizontal-20-solid",color:"neutral",variant:"soft"})]),_:1},8,["items"])]),default:s(()=>[l(J,{columns:[{accessorKey:"index",header:"#"},{accessorKey:"channel",header:t(n)("table.channel_id")},{accessorKey:"link",header:t(n)("purchase_link.download_links")}],data:t(I),ui:{thead:"whitespace-nowrap"}},{"index-cell":s(({row:o})=>[ge(g(o.index+1),1)]),"link-cell":s(({row:o})=>[m("div",za,[l(d,{icon:"i-heroicons-qr-code",variant:"outline",size:"xs",onClick:Ee=>q.value=o.original},null,8,["onClick"]),l(d,{icon:"i-heroicons-document-duplicate",size:"xs",variant:"outline",disabled:!o.original.url,onClick:Ee=>$e(o.original.url)},null,8,["disabled","onClick"]),l(d,{class:"font-mono break-all",label:o.original.url,to:o.original.url,color:"neutral",variant:"outline",size:"xs",target:"_blank"},null,8,["label","to"])])]),_:1},8,["columns","data"])]),_:1})):t(I)[0]?(y(),M("div",qa,[l(d,{icon:"i-heroicons-qr-code",variant:"outline",size:"xs",onClick:a[8]||(a[8]=o=>q.value=t(I)[0])}),l(d,{icon:"i-heroicons-document-duplicate",size:"xs",variant:"outline",disabled:!t(I)[0]?.url,onClick:a[9]||(a[9]=o=>$e(t(I)[0]?.url||""))},null,8,["disabled"]),l(d,{icon:"i-heroicons-arrow-top-right-on-square",to:t(I)[0].url,target:"_blank",size:"xs",variant:"outline"},null,8,["to"]),l(re,{class:"grow font-mono","model-value":t(I)[0].url,disabled:!0,color:"neutral",variant:"outline",size:"xs"},null,8,["model-value"])])):N("",!0)]),_:1}),l(ve,{label:t(n)("form.table_of_content")},{default:s(()=>[l($t,{modelValue:t(C),"onUpdate:modelValue":a[10]||(a[10]=o=>W(C)?C.value=o:null),rows:8,placeholder:`- Chapter 1
- Chapter 2
  - Section 2.1`},null,8,["modelValue"])]),_:1},8,["label"])]),m("div",Ha,[l(d,{label:t(n)("common.save"),loading:t(U),size:"lg",disabled:t(U),onClick:yt},null,8,["label","loading","disabled"])])],64)):N("",!0)]),_:1})],64)):N("",!0),l(Le,{open:t(se),"onUpdate:open":a[12]||(a[12]=o=>W(se)?se.value=o:null)},{content:s(()=>[t(q)?(y(),F(Ut,{key:0,data:t(q).url,"file-name":ot(t(q).channel),width:500,height:500},{header:s(()=>[m("h3",{class:"font-bold font-mono",textContent:g(t(n)("purchase_link.download_qr_modal"))},null,8,Qa),l(d,{icon:"i-heroicons-x-mark",color:"neutral",variant:"ghost",onClick:a[11]||(a[11]=o=>se.value=!1)})]),_:1},8,["data","file-name"])):N("",!0)]),_:1},8,["open"]),l(Le,{open:t(G),"onUpdate:open":a[13]||(a[13]=o=>W(G)?G.value=o:null)},{content:s(()=>[l(Dt,{"is-restock":!0,"restock-count":t(le),"iscn-id":t(f),onSubmit:St},null,8,["restock-count","iscn-id"])]),_:1},8,["open"]),l(Ft,{transition:!1})]),_:1})}}});export{go as default};
